<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; font-src 'self' data:; img-src 'self' data:;">
  <title>Kawaii Terminal</title>
  <link rel="stylesheet" href="../../node_modules/@xterm/xterm/css/xterm.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- xterm.js をグローバルにロード -->
  <script src="../../node_modules/@xterm/xterm/lib/xterm.js"></script>
  <script src="../../node_modules/@xterm/addon-fit/lib/addon-fit.js"></script>
  <script src="../../node_modules/@xterm/addon-search/lib/addon-search.js"></script>
  <script src="../../node_modules/@xterm/addon-serialize/lib/addon-serialize.js"></script>
  <script src="../../node_modules/@xterm/addon-web-links/lib/addon-web-links.js"></script>
  <script src="../../node_modules/@xterm/addon-webgl/lib/addon-webgl.js"></script>

  <!-- デバッグメニュー -->
  <div class="debug-menu" id="debug-menu">
    <div class="debug-menu-item" data-style="auto">Auto (System)</div>
    <div class="debug-menu-item" data-style="win">Windows Style</div>
    <div class="debug-menu-item" data-style="mac">macOS Style</div>
    <div class="debug-menu-divider"></div>
    <div class="debug-menu-item" id="cheer-boost">Cheer Boost (1m)</div>
    <div class="debug-menu-item" id="terminal-health-toggle">Terminal Health</div>
    <div class="debug-menu-item" id="toggle-status-debug">Toggle Status Debug</div>
    <div class="debug-menu-divider"></div>
    <div class="debug-menu-item" id="toggle-devtools">Toggle DevTools</div>
    <div class="debug-menu-divider"></div>
    <div class="debug-menu-item" id="reset-app-data">Full Reset (App Data + Temp)</div>
    <div class="debug-menu-item" id="reset-app-data-claude">Full Reset + Rollback Claude Hooks</div>
  </div>
  <div class="terminal-health-panel" id="terminal-health-panel" aria-hidden="true">
    <div class="terminal-health-title" id="terminal-health-title">
      <span>Terminal Health</span>
      <button class="terminal-health-refresh" id="terminal-health-refresh" title="Refresh">↻</button>
    </div>
    <pre class="terminal-health-body" id="terminal-health-body"></pre>
  </div>

  <!-- メインコンテナ -->
  <div class="container" id="main-container">
    <!-- Left activity bar + pane -->
    <div class="left-shell" id="left-shell">
      <div class="left-shell-drag" aria-hidden="true"></div>
      <div class="activity-bar" id="activity-bar">
        <button class="activity-item" data-pane="active" title="Active Agents">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path d="M12 3l9 4.5-9 4.5-9-4.5 9-4.5z" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <path d="M3 12l9 4.5 9-4.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M3 16.5l9 4.5 9-4.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="activity-item active" data-pane="history" title="History">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path d="M12 6a6 6 0 1 1-4.24 1.76" fill="none" stroke="currentColor" stroke-width="1.5"/>
            <path d="M8 4v3h3" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M12 9v4l3 2" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="activity-item" data-pane="search" title="Search">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <circle cx="11" cy="11" r="6" fill="none" stroke="currentColor" stroke-width="1.6"/>
            <path d="M16.2 16.2L20 20" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="activity-item" data-pane="pins" title="Pins">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path d="M16 12V4h1V2H7v2h1v8l-2 2v2h5v6l1 1 1-1v-6h5v-2l-2-2z" fill="currentColor"/>
          </svg>
        </button>
        <div class="activity-spacer"></div>
        <button class="activity-item activity-settings" data-action="settings" title="Settings">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z" fill="currentColor"/>
          </svg>
        </button>
      </div>
      <div class="left-pane" id="left-pane" aria-hidden="false">
        <div class="left-pane-panel left-pane-active" data-pane="active" id="left-pane-active">
          <div class="session-sidebar session-sidebar-active-pane">
            <div class="session-sidebar-header">
              <span class="session-sidebar-title">Active Agents</span>
              <span class="session-sidebar-count" id="active-session-sidebar-count">0</span>
            </div>
            <div class="session-sidebar-body">
              <div class="session-group-list" id="active-session-group-list"></div>
            </div>
          </div>
        </div>
        <div class="left-pane-panel left-pane-history active" data-pane="history">
          <div class="session-sidebar" id="session-sidebar" aria-hidden="false">
            <div class="session-sidebar-header">
              <span class="session-sidebar-title">Agents History</span>
              <span class="session-sidebar-count" id="session-sidebar-count">0</span>
            </div>
            <div class="session-sidebar-body">
              <div class="session-group-list" id="session-group-list"></div>
            </div>
          </div>
        </div>
        <div class="left-pane-panel left-pane-search" data-pane="search" id="left-pane-search">
          <div class="session-sidebar session-sidebar-search-pane">
            <div class="session-sidebar-header">
              <span class="session-sidebar-title">Search</span>
              <span class="session-sidebar-count" id="session-search-count">0</span>
            </div>
            <div class="session-sidebar-search">
              <div class="session-sidebar-search-input">
                <svg viewBox="0 0 24 24" width="14" height="14" aria-hidden="true">
                  <circle cx="11" cy="11" r="6" fill="none" stroke="currentColor" stroke-width="1.6"/>
                  <path d="M16.2 16.2L20 20" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
                </svg>
                <input type="text" id="session-search-input" placeholder="Search history" autocomplete="off" spellcheck="false" />
                <button class="session-sidebar-search-clear" id="session-search-clear" title="Clear search">&#x2715;</button>
              </div>
              <div class="session-sidebar-search-status" id="session-search-status"></div>
            </div>
            <div class="session-sidebar-body">
              <div class="session-search-list" id="session-search-list"></div>
            </div>
          </div>
        </div>
        <div class="left-pane-panel left-pane-pins" data-pane="pins" id="preview-pane-pins">
          <div class="session-sidebar-header pins-sidebar-header">
            <span class="session-sidebar-title">Agents Pins</span>
            <span class="session-sidebar-count" id="pin-sidebar-count">0</span>
          </div>
          <div class="pins-sidebar-body">
            <div class="pin-list" id="pin-list"></div>
          </div>
        </div>
        <div class="terminal-preview-toast left-pane-toast" id="terminal-preview-toast"></div>
      </div>
    </div>
    <div class="session-sidebar-resizer" id="session-sidebar-resizer" aria-hidden="true">
      <span class="session-sidebar-resizer-icon">&gt;</span>
      <span class="session-sidebar-resizer-label">AGENTS HISTORY</span>
    </div>

    <!-- ターミナル -->
    <div class="terminal-panel">
      <!-- カスタムタイトルバー（タブ統合） -->
      <div class="titlebar" id="titlebar">
        <div class="titlebar-tabs-wrapper">
          <button class="tab-scroll-btn tab-scroll-left" id="tab-scroll-left" title="Scroll tabs left">
            <svg viewBox="0 0 12 12"><path d="M8 2L4 6l4 4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="titlebar-tabs" id="terminal-tabs">
            <!-- タブはJSで動的に追加 -->
            <button class="terminal-tab-add" id="terminal-tab-add" title="New Tab">+</button>
            <button class="terminal-tab-add-menu" id="terminal-tab-add-menu" title="New Tab Options" aria-label="New Tab Options">
              <svg viewBox="0 0 12 12" aria-hidden="true">
                <path d="M2 4l4 4 4-4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
          <button class="tab-scroll-btn tab-scroll-right" id="tab-scroll-right" title="Scroll tabs right">
            <svg viewBox="0 0 12 12"><path d="M4 2l4 4-4 4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="terminal-tabs-actions" id="terminal-tabs-actions">
          </div>
        </div>
        <div class="titlebar-drag" id="titlebar-drag"></div>
        <div class="titlebar-buttons">
          <button class="titlebar-button minimize" id="btn-minimize">&#x2212;</button>
          <button class="titlebar-button maximize" id="btn-maximize">&#x25A1;</button>
          <button class="titlebar-button close" id="btn-close">&#x2715;</button>
        </div>
      </div>
      <div class="terminal-stack" id="terminal-stack"></div>
	      <div class="terminal-drop-overlay" id="terminal-drop-overlay">Drop files to paste path</div>
	      <div class="terminal-search" id="terminal-search">
	        <input type="text" id="terminal-search-input" placeholder="Search in terminal (Enter/Shift+Enter)" />
	        <button class="terminal-search-btn" id="terminal-search-prev" title="Previous">&#x25B2;</button>
	        <button class="terminal-search-btn" id="terminal-search-next" title="Next">&#x25BC;</button>
	        <button class="terminal-search-btn close" id="terminal-search-close" title="Close">&#x2715;</button>
	      </div>
			    </div>
			  </div>

  <!-- ステータスバー（アバター＋応援メッセージ） -->
  <div class="status-bar" id="status-bar">
    <div class="status-bar-avatar" id="status-bar-avatar">
      <img id="avatar-image" src="../../assets/avatar/default.png" alt="Avatar">
    </div>
    <div class="status-bar-message" id="cheer-bubble"></div>
    <button class="status-bar-settings" id="settings-btn" title="Settings">
      <svg viewBox="0 0 24 24" width="14" height="14">
        <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12 3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66z" fill="currentColor"/>
      </svg>
    </button>
  </div>

  <!-- アバターホバーポップアップ -->
  <div class="avatar-popup" id="avatar-popup">
    <div class="avatar-popup-container">
      <img class="avatar-popup-image" id="avatar-popup-image" src="../../assets/avatar/default.png" alt="Avatar">
    </div>
    <div class="avatar-popup-bubble" id="avatar-popup-bubble"></div>
  </div>

  <!-- 設定ウィンドウ -->
  <div class="settings-panel" id="settings-panel" aria-hidden="true">
    <div class="settings-window" role="dialog" aria-modal="true" aria-label="Settings" tabindex="-1">
      <div class="settings-window-header">
        <div class="settings-window-title">Settings</div>
        <div class="settings-window-actions">
          <button class="settings-close" id="settings-close" aria-label="Close settings">&#x2715;</button>
        </div>
      </div>

      <div class="settings-window-body">
        <aside class="settings-sidebar">
          <button class="settings-nav-item active" data-settings-section="cheer">
            <svg class="settings-nav-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M16 18a2 2 0 0 1 2 2a2 2 0 0 1 2 -2a2 2 0 0 1 -2 -2a2 2 0 0 1 -2 2m0 -12a2 2 0 0 1 2 2a2 2 0 0 1 2 -2a2 2 0 0 1 -2 -2a2 2 0 0 1 -2 2m-7 12a6 6 0 0 1 6 -6a6 6 0 0 1 -6 -6a6 6 0 0 1 -6 6a6 6 0 0 1 6 6" />
            </svg>
            Cheer
          </button>
          <button class="settings-nav-item" data-settings-section="terminal">
            <svg class="settings-nav-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M8 9l3 3l-3 3" />
              <path d="M13 15l3 0" />
              <path d="M3 6a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2l0 -12" />
            </svg>
            Terminal
          </button>
          <button class="settings-nav-item" data-settings-section="agents">
            <svg class="settings-nav-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M12 3l9 4.5-9 4.5-9-4.5 9-4.5z" />
              <path d="M3 12l9 4.5 9-4.5" />
              <path d="M3 16.5l9 4.5 9-4.5" />
            </svg>
            Agents
          </button>
          <button class="settings-nav-item" data-settings-section="interface">
            <svg class="settings-nav-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M4 5h16a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-12a1 1 0 0 1 1 -1" />
              <path d="M4 9h16" />
              <path d="M9 9v10" />
            </svg>
            Interface
          </button>
          <button class="settings-nav-item" data-settings-section="shortcuts">
            <svg class="settings-nav-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M5 7h14a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-6a2 2 0 0 1 2 -2z" />
              <path d="M8 11h0" />
              <path d="M12 11h0" />
              <path d="M16 11h0" />
              <path d="M8 15h8" />
            </svg>
            Shortcuts
          </button>
        </aside>

        <div class="settings-content">
          <section class="settings-pane active" data-settings-panel="cheer">
            <div class="settings-content-header">
              <div class="settings-content-title">Cheer</div>
            </div>

            <div class="settings-section-label">DISPLAY</div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Enable Cheer</div>
                <div class="settings-row-subtitle">応援メッセージを表示 / Show cheer messages</div>
              </div>
              <div class="settings-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="cheer-enabled" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Interval</div>
                <div class="settings-row-subtitle">応援の表示間隔（分） / Interval in minutes</div>
              </div>
              <div class="settings-row-control">
                <input type="number" class="settings-input settings-input-wheel" id="cheer-interval" min="1" max="60" step="1" value="30">
              </div>
            </div>
          </section>

          <section class="settings-pane" data-settings-panel="terminal">
            <div class="settings-content-header">
              <div class="settings-content-title">Terminal</div>
            </div>

            <div class="settings-section-label">TERMINAL</div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Font Size</div>
                <div class="settings-row-subtitle">端末フォントのサイズ / Terminal font size</div>
              </div>
              <div class="settings-row-control">
                <input type="number" class="settings-input settings-input-wheel" id="terminal-font-size" min="10" max="32" step="1" value="14">
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Scrollback Lines</div>
                <div class="settings-row-subtitle">履歴の保持行数 / Scrollback lines</div>
              </div>
              <div class="settings-row-control">
                <input type="number" class="settings-input settings-input-wheel" id="terminal-scrollback" min="1000" max="50000" step="500" value="5000">
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">GPU Acceleration (WebGL)</div>
                <div class="settings-row-subtitle">描画パフォーマンスを優先 / Prefer rendering performance</div>
              </div>
              <div class="settings-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="terminal-webgl">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </section>

          <section class="settings-pane" data-settings-panel="agents">
            <div class="settings-content-header">
              <div class="settings-content-title">Agents</div>
            </div>

            <div class="settings-section-label">INTEGRATION</div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Apply now</div>
                <div class="settings-row-subtitle settings-status" id="hooks-notify-status">Not applied</div>
              </div>
              <div class="settings-row-control">
                <button class="settings-ghost-button" id="hooks-notify-apply" type="button">Apply</button>
              </div>
            </div>

            <div class="settings-section-label">SUMMARY</div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Session Summaries</div>
                <div class="settings-row-subtitle">Active Agents の要約を表示 / Show summaries for active agents</div>
              </div>
              <div class="settings-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="summary-enabled">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>

            <div class="settings-row" id="summary-provider-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Session Summaries Provider</div>
                <div class="settings-row-subtitle" id="summary-provider-status">Session Summaries で使う提供元 / Detecting...</div>
              </div>
              <div class="settings-row-control">
                <select class="settings-select" id="summary-provider">
                  <option value="claude">Claude</option>
                  <option value="gemini">Gemini</option>
                </select>
              </div>
            </div>

            <div class="settings-row" id="summary-gemini-key-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Gemini API Key</div>
                <div class="settings-row-subtitle" id="summary-gemini-key-status">Not set</div>
              </div>
              <div class="settings-row-control">
                <input type="password" class="settings-input" id="summary-gemini-api-key" placeholder="AIza..." autocomplete="off" spellcheck="false">
              </div>
            </div>

            <div class="settings-row" id="summary-pane-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Pane Overlay</div>
                <div class="settings-row-subtitle">右上ペインに要約を表示 / Show summary in pane overlay</div>
              </div>
              <div class="settings-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="summary-pane-enabled">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>

          </section>

          <section class="settings-pane" data-settings-panel="interface">
            <div class="settings-content-header">
              <div class="settings-content-title">Interface</div>
            </div>

            <div class="settings-section-label">INTERFACE</div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Language</div>
                <div class="settings-row-subtitle">要約の言語 / Summary language</div>
              </div>
              <div class="settings-row-control">
                <select class="settings-select" id="cheer-language">
                  <option value="ja">日本語</option>
                  <option value="en">English</option>
                </select>
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Theme</div>
                <div class="settings-row-subtitle">UI theme / UIテーマ</div>
              </div>
              <div class="settings-row-control">
                <select class="settings-select" id="theme-select">
                  <option value="dark">Dark</option>
                  <option value="light">Light</option>
                </select>
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Left Pane Scale</div>
                <div class="settings-row-subtitle">左ペイン全体のスケール / Left pane scale</div>
              </div>
              <div class="settings-row-control">
                <input type="number" class="settings-input settings-input-wheel" id="left-pane-font-scale" min="0.5" max="2" step="0.05" value="1">
              </div>
            </div>

            <div class="settings-row">
              <div class="settings-row-text">
                <div class="settings-row-title">Left Pane Smooth Scroll (UI)</div>
                <div class="settings-row-subtitle">UIのみ有効（ターミナルには影響しません） / UI only (does not affect terminal)</div>
              </div>
              <div class="settings-row-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="left-pane-smooth-scroll">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </section>

          <section class="settings-pane" data-settings-panel="shortcuts">
            <div class="settings-content-header">
              <div class="settings-content-title">Shortcuts</div>
            </div>

            <div class="settings-shortcut-toolbar">
              <div class="settings-shortcut-platform" id="shortcut-platform-label">macOS</div>
              <div class="settings-shortcut-actions">
                <button class="settings-ghost-button" id="shortcut-reset-all" type="button">Reset all</button>
              </div>
            </div>

            <div class="settings-shortcut-list" id="shortcut-list"></div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <!-- ターミナルコンテキストメニュー -->
  <div class="terminal-context-menu" id="terminal-context-menu">
    <div class="context-menu-item" data-action="copy" data-shortcut="terminal:copy">
      <span class="context-menu-label">Copy</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-item" data-action="paste" data-shortcut="terminal:paste">
      <span class="context-menu-label">Paste</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-item" data-action="find" data-shortcut="terminal:find">
      <span class="context-menu-label">Find</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item" data-action="pin" data-shortcut="view:pin">
      <span class="context-menu-label">Pin last output</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item" data-action="split-right" data-shortcut="pane:split-right">
      <span class="context-menu-label">Split Right</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-item" data-action="split-down" data-shortcut="pane:split-down">
      <span class="context-menu-label">Split Down</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-item" data-action="close-pane" data-shortcut="pane:close">
      <span class="context-menu-label">Close Pane</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item" data-action="clear" data-shortcut="terminal:clear">
      <span class="context-menu-label">Clear</span>
      <span class="context-menu-hint" aria-hidden="true"></span>
    </div>
  </div>

  <!-- タブコンテキストメニュー -->
  <div class="terminal-tab-menu" id="terminal-tab-menu">
    <div class="tab-menu-item" data-action="rename">Rename</div>
    <div class="tab-menu-item" data-action="reset">Reset Title</div>
    <div class="tab-menu-divider"></div>
    <div class="tab-menu-item" data-action="close">Close Tab</div>
    <div class="tab-menu-item" data-action="close-others">Close Other Tabs</div>
    <div class="tab-menu-item" data-action="close-right">Close Tabs to the Right</div>
  </div>

  <div class="terminal-tab-menu terminal-profile-menu" id="terminal-profile-menu"></div>

  <!-- ショートカットチートシート -->
  <div class="shortcut-sheet" id="shortcut-sheet">
    <div class="shortcut-sheet-content" id="shortcut-sheet-content"></div>
    <div class="shortcut-hint" id="shortcut-sheet-hint"></div>
  </div>

  <!-- セッションリカバリモーダル -->
  <div class="recovery-modal-overlay" id="recovery-modal-overlay">
    <div class="recovery-modal">
      <div class="recovery-modal-header">Session interrupted</div>
      <div class="recovery-modal-meta"><span id="recovery-windows">0</span> win · <span id="recovery-tabs">0</span> tab · <span id="recovery-panes">0</span> pane</div>
      <div class="recovery-modal-actions">
        <button class="recovery-btn" id="recovery-restore-all">Restore all</button>
        <button class="recovery-btn" id="recovery-restore-last">Last window</button>
        <button class="recovery-btn recovery-btn-secondary" id="recovery-start-fresh">New session</button>
      </div>
    </div>
  </div>

  <div class="onboarding-panel" id="onboarding-overlay" aria-hidden="true">
    <div class="onboarding-window" role="dialog" aria-modal="true" aria-label="Setup">
      <div class="onboarding-content">
        <div class="onboarding-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
            <path d="M2 12C2 16.714 2 19.0711 3.46447 20.5355C4.92893 22 7.28595 22 12 22C16.714 22 19.0711 22 20.5355 20.5355C22 19.0711 22 16.714 22 12V10.5M13.5 2H12C7.28595 2 4.92893 2 3.46447 3.46447C2.49073 4.43821 2.16444 5.80655 2.0551 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="19" cy="5" r="3" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </div>
        <div class="onboarding-title">Configure Claude Code Hooks</div>
        <div class="onboarding-desc">
          Enable Claude Code status in the sidebar by adding hooks to settings.json. We safely append to your config (backup created, existing settings preserved). Codex works out of the box.
          <span class="onboarding-tagline">We <span class="ultrathink">ultrathink</span> your workflow.</span>
        </div>
        <div class="onboarding-status-line" id="onboarding-apply-status"></div>
        <div class="onboarding-footer">
          <div class="onboarding-footer-left onboarding-footer-stack">
            <button class="onboarding-button secondary" id="onboarding-close">Don't enable hooks</button>
            <button class="onboarding-dismiss-link" id="onboarding-dismiss-link" type="button">Don't show again</button>
          </div>
          <div class="onboarding-footer-right">
            <button class="onboarding-button primary" id="onboarding-apply">Configure</button>
          </div>
        </div>
        <!-- JS compatibility (hidden) -->
        <div style="display:none">
          <span id="onboarding-hooks-local"></span>
          <span id="onboarding-hooks-wsl-row"><span id="onboarding-hooks-wsl"></span></span>
          <span id="onboarding-include-wsl-row"></span>
          <span id="onboarding-claude-local"></span>
          <span id="onboarding-claude-wsl-row"><span id="onboarding-claude-wsl"></span></span>
          <span id="onboarding-codex-local"></span>
          <span id="onboarding-codex-wsl-row"><span id="onboarding-codex-wsl"></span></span>
        </div>
      </div>
      <div class="onboarding-result" aria-hidden="true">
        <div class="onboarding-result-icon success" aria-hidden="true">
          <svg viewBox="0 0 72 72" fill="none">
            <circle class="onboarding-result-ring" cx="36" cy="36" r="26" />
            <path class="onboarding-result-check" d="M22 36.5L32 46.5L50 28.5" />
          </svg>
        </div>
        <div class="onboarding-result-icon error" aria-hidden="true">
          <svg viewBox="0 0 72 72" fill="none">
            <circle class="onboarding-result-ring" cx="36" cy="36" r="26" />
            <path class="onboarding-result-x" d="M26 26L46 46" />
            <path class="onboarding-result-x" d="M46 26L26 46" />
          </svg>
        </div>
        <div class="onboarding-result-text" id="onboarding-result-text"></div>
      </div>
    </div>
  </div>

		  <script src="theme/theme-loader.js"></script>
		  <script src="theme/theme-runtime.js"></script>
		  <script src="link-detection.js"></script>
		  <script src="terminal/terminal.js"></script>
		  <script src="avatar.js"></script>
		  <script src="cheer-manager.js"></script>
		  <script src="pin-manager.js"></script>
		  <script src="history/history-store.js"></script>
		  <script src="history/history-session-tracker.js"></script>
		  <script src="ui/history-sidebar-ui.js"></script>
		  <script src="ui/history-search-ui.js"></script>
		  <script src="history-manager.js"></script>
		  <script src="runtime/history-client.js"></script>
		  <script src="runtime/status-client.js"></script>
		  <script src="summary/summary-manager.js"></script>
		  <script src="runtime/ui-utils.js"></script>
		  <script src="ui/input-utils.js"></script>
		  <script src="image-preview.js"></script>
		  <script src="md-preview.js"></script>
		  <script src="ui/left-pane.js"></script>
		  <script src="ui/window-ui.js"></script>
		  <script src="terminal/terminal-ui.js"></script>
		  <script src="terminal/terminal-tabs.js"></script>
		  <script src="actions/shortcuts.js"></script>
		  <script src="terminal/terminal-dnd.js"></script>
		  <script src="actions/action-dispatcher.js"></script>
		  <script src="terminal/terminal-shortcuts.js"></script>
		  <script src="ui/settings-ui.js"></script>
		  <script src="ui/onboarding-ui.js"></script>
		  <script src="app/tab-transfer.js"></script>
		  <script src="app/session-persistence.js"></script>
		  <script src="app/bootstrap.js"></script>
		  <script src="renderer.js"></script>
		</body>
	</html>
