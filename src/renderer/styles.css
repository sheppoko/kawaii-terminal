/* 内蔵フォント */
@font-face {
  font-family: 'Inter';
  src: url('../../assets/fonts/InterVariable.ttf') format('truetype');
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'HackGen Console NF';
  src: url('../../assets/fonts/HackGenConsoleNF-Regular.ttf') format('truetype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --activity-bar-width: 48px;
  --status-bar-height: 28px;
  --titlebar-height: 36px;
  --left-pane-font-scale: 1;

  /* Base palette */
  --kt-color-base-neutral-0: #000000;
  --kt-color-base-neutral-10: #0a0a0a;
  --kt-color-base-neutral-20: #0e0e0e;
  --kt-color-base-neutral-30: #13161b;
  --kt-color-base-neutral-40: #1a1a1a;
  --kt-color-base-neutral-50: #2a2a2a;
  --kt-color-base-neutral-60: #3a3a3a;
  --kt-color-base-neutral-70: #5a5a5a;
  --kt-color-base-neutral-80: #9a9a9a;
  --kt-color-base-neutral-90: #e0e0e0;
  --kt-color-base-neutral-100: #ffffff;
  --kt-color-base-accent-primary: #3b82f6;
  --kt-color-base-status-success: #22c55e;
  --kt-color-base-status-warning: #f59e0b;
  --kt-color-base-status-error: #ef4444;
  --kt-color-base-status-info: #60a5fa;

  /* Alpha scale */
  --kt-color-alpha-white-04: rgba(255, 255, 255, 0.04);
  --kt-color-alpha-white-06: rgba(255, 255, 255, 0.06);
  --kt-color-alpha-white-08: rgba(255, 255, 255, 0.08);
  --kt-color-alpha-white-12: rgba(255, 255, 255, 0.12);
  --kt-color-alpha-white-16: rgba(255, 255, 255, 0.16);
  --kt-color-alpha-white-20: rgba(255, 255, 255, 0.2);
  --kt-color-alpha-white-24: rgba(255, 255, 255, 0.24);
  --kt-color-alpha-white-32: rgba(255, 255, 255, 0.32);
  --kt-color-alpha-white-50: rgba(255, 255, 255, 0.5);
  --kt-color-alpha-white-70: rgba(255, 255, 255, 0.7);
  --kt-color-alpha-white-90: rgba(255, 255, 255, 0.9);
  --kt-color-alpha-black-20: rgba(0, 0, 0, 0.2);
  --kt-color-alpha-black-35: rgba(0, 0, 0, 0.35);
  --kt-color-alpha-black-50: rgba(0, 0, 0, 0.5);
  --kt-color-alpha-black-65: rgba(0, 0, 0, 0.65);
  --kt-color-alpha-black-80: rgba(0, 0, 0, 0.8);

  /* Semantic colors */
  --kt-color-bg-canvas: var(--kt-color-base-neutral-0);
  --kt-color-bg-surface: var(--kt-color-base-neutral-10);
  --kt-color-bg-surface-1: var(--kt-color-base-neutral-20);
  --kt-color-bg-surface-2: var(--kt-color-base-neutral-30);
  --kt-color-bg-surface-3: var(--kt-color-base-neutral-40);
  --kt-color-bg-elevated: #1b1b1b;
  --kt-color-bg-overlay: var(--kt-color-alpha-black-50);

  --kt-color-text-primary: var(--kt-color-base-neutral-90);
  --kt-color-text-secondary: var(--kt-color-base-neutral-80);
  --kt-color-text-muted: #7a7a7a;
  --kt-color-text-faint: #555555;
  --kt-color-text-emphasis: var(--kt-color-base-neutral-100);
  --kt-color-text-disabled: #4a4a4a;
  --kt-color-text-inverse: var(--kt-color-base-neutral-0);
  --kt-color-text-on-accent: var(--kt-color-base-neutral-100);

  --kt-color-border-subtle: var(--kt-color-alpha-white-06);
  --kt-color-border-default: var(--kt-color-base-neutral-50);
  --kt-color-border-strong: var(--kt-color-base-neutral-60);
  --kt-color-border-focus: var(--kt-color-base-accent-primary);
  --kt-color-border-accent: var(--kt-color-base-accent-primary);

  --kt-color-state-hover: var(--kt-color-alpha-white-04);
  --kt-color-state-active: var(--kt-color-alpha-white-08);
  --kt-color-state-pressed: var(--kt-color-alpha-white-12);
  --kt-color-state-selected: var(--kt-color-alpha-white-12);
  --kt-color-state-focus-ring: var(--kt-color-alpha-white-20);

  --kt-color-accent-primary: var(--kt-color-base-accent-primary);
  --kt-color-accent-primary-weak: rgba(59, 130, 246, 0.2);
  --kt-color-accent-primary-strong: rgba(59, 130, 246, 0.5);
  --kt-color-accent-on-primary: var(--kt-color-base-neutral-100);

  --kt-color-status-success: var(--kt-color-base-status-success);
  --kt-color-status-success-weak: rgba(34, 197, 94, 0.35);
  --kt-color-status-success-soft: rgba(34, 197, 94, 0.15);
  --kt-color-status-warning: var(--kt-color-base-status-warning);
  --kt-color-status-warning-weak: rgba(245, 158, 11, 0.2);
  --kt-color-status-error: var(--kt-color-base-status-error);
  --kt-color-status-error-weak: rgba(239, 68, 68, 0.2);
  --kt-color-status-info: var(--kt-color-base-status-info);
  --kt-color-status-info-weak: rgba(96, 165, 250, 0.2);
  --kt-color-status-info-glow: rgba(96, 165, 250, 0.45);
  --kt-color-status-warning-soft: rgba(245, 158, 11, 0.18);
  --kt-color-status-warning-strong: rgba(245, 158, 11, 0.9);
  --kt-color-status-warning-glow: rgba(245, 158, 11, 0.45);
  --kt-color-status-success-border: rgba(16, 185, 129, 0.4);
  --kt-color-status-success-glow: rgba(34, 197, 94, 0.55);
  --kt-color-status-error-glow: rgba(239, 68, 68, 0.4);

  --kt-color-icon-primary: var(--kt-color-text-primary);
  --kt-color-icon-muted: var(--kt-color-text-secondary);
  --kt-color-icon-accent: var(--kt-color-accent-primary);

  --kt-color-scrollbar-track: transparent;
  --kt-color-scrollbar-thumb: var(--kt-color-base-neutral-60);
  --kt-color-scrollbar-thumb-hover: var(--kt-color-base-neutral-70);

  /* Terminal theme */
  --kt-color-terminal-bg: #000000;
  --kt-color-terminal-fg: #cccccc;
  --kt-color-terminal-cursor: #ffffff;
  --kt-color-terminal-cursor-accent: #000000;
  --kt-color-terminal-selection: rgba(255, 255, 255, 0.3);
  --kt-color-terminal-selection-inactive: rgba(255, 255, 255, 0.3);
  --kt-color-terminal-ansi-black: #000000;
  --kt-color-terminal-ansi-red: #c50f1f;
  --kt-color-terminal-ansi-green: #13a10e;
  --kt-color-terminal-ansi-yellow: #c19c00;
  --kt-color-terminal-ansi-blue: #0037da;
  --kt-color-terminal-ansi-magenta: #881798;
  --kt-color-terminal-ansi-cyan: #3a96dd;
  --kt-color-terminal-ansi-white: #cccccc;
  --kt-color-terminal-ansi-bright-black: #767676;
  --kt-color-terminal-ansi-bright-red: #e74856;
  --kt-color-terminal-ansi-bright-green: #16c60c;
  --kt-color-terminal-ansi-bright-yellow: #f9f1a5;
  --kt-color-terminal-ansi-bright-blue: #3b78ff;
  --kt-color-terminal-ansi-bright-magenta: #b4009e;
  --kt-color-terminal-ansi-bright-cyan: #61d6d6;
  --kt-color-terminal-ansi-bright-white: #f2f2f2;

  /* Syntax (GitHub Dark baseline) */
  --kt-color-syntax-text: #e6edf3;
  --kt-color-syntax-comment: #8b949e;
  --kt-color-syntax-keyword: #ff7b72;
  --kt-color-syntax-tag: #7ee787;
  --kt-color-syntax-attr: #79c0ff;
  --kt-color-syntax-string: #a5d6ff;
  --kt-color-syntax-title: #d2a8ff;
  --kt-color-syntax-type: #ffa657;
  --kt-color-syntax-number: #79c0ff;
  --kt-color-syntax-meta: #8b949e;
  --kt-color-syntax-deletion: #ffa198;
  --kt-color-syntax-deletion-bg: rgba(255, 129, 130, 0.15);
  --kt-color-syntax-addition: #7ee787;
  --kt-color-syntax-addition-bg: rgba(63, 185, 80, 0.15);

  /* Component: buttons */
  --kt-color-component-button-ghost-bg: var(--kt-color-alpha-white-06);
  --kt-color-component-button-ghost-border: var(--kt-color-alpha-white-12);
  --kt-color-component-button-ghost-hover-bg: var(--kt-color-alpha-white-12);
  --kt-color-component-button-ghost-hover-border: var(--kt-color-alpha-white-20);
  --kt-color-component-button-success-bg: rgba(74, 222, 128, 0.1);
  --kt-color-component-button-success-border: rgba(74, 222, 128, 0.2);
  --kt-color-component-button-success-text: #86efac;
  --kt-color-component-button-danger-bg: rgba(248, 113, 113, 0.1);
  --kt-color-component-button-danger-border: rgba(248, 113, 113, 0.2);
  --kt-color-component-button-danger-text: #fca5a5;
  --kt-color-component-button-warning-bg: rgba(251, 191, 36, 0.1);
  --kt-color-component-button-warning-border: rgba(251, 191, 36, 0.2);
  --kt-color-component-button-warning-text: #fde047;
  --kt-color-component-button-info-bg: rgba(96, 165, 250, 0.1);
  --kt-color-component-button-info-border: rgba(96, 165, 250, 0.2);
  --kt-color-component-button-info-text: #93c5fd;

  /* Component: session pane */
  --kt-color-component-session-pane-bg: rgba(14, 14, 14, 0.95);
  --kt-color-component-session-pane-bg-strong: rgba(20, 20, 20, 0.98);
  --kt-color-component-session-pane-bg-muted: rgba(12, 12, 12, 0.98);
  --kt-color-component-session-pane-bg-strong-hover: rgba(30, 30, 30, 0.98);
  --kt-color-component-session-pane-bg-muted-hover: rgba(16, 16, 16, 0.98);
  --kt-color-component-session-pane-border: var(--kt-color-border-default);
  --kt-color-component-session-pane-border-subtle: var(--kt-color-border-subtle);
  --kt-color-component-session-pane-hover: var(--kt-color-alpha-white-04);
  --kt-color-component-session-pane-active: var(--kt-color-alpha-white-06);
  --kt-color-component-session-pane-item-hover: rgba(255, 248, 242, 0.035);
  --kt-color-component-session-pane-item-active: rgba(255, 242, 230, 0.06);
  --kt-color-component-session-pane-chip-bg: rgba(255, 232, 214, 0.12);
  --kt-color-component-session-provider-codex-bg: var(--kt-color-alpha-white-12);
  --kt-color-component-session-provider-codex-text: var(--kt-color-alpha-white-90);
  --kt-color-component-session-pane-divider: var(--kt-color-alpha-white-04);
  --kt-color-component-session-pane-divider-strong: var(--kt-color-alpha-white-12);
  --kt-color-component-session-pane-scrollbar: var(--kt-color-alpha-white-12);
  --kt-color-component-session-pane-scrollbar-hover: var(--kt-color-alpha-white-16);
  --kt-color-component-session-pane-text-primary: #b3b3b3;
  --kt-color-component-session-pane-text-secondary: #7a7a7a;
  --kt-color-component-session-pane-text-faint: #4a4a4a;
  --kt-color-component-session-card-bg: #0e0e0e;
  --kt-color-component-session-card-hover: #151515;
  --kt-color-component-session-card-active: #1b1b1b;

  /* Component: settings window */
  --settings-window-width: min(1040px, 92vw);
  --settings-window-height: min(760px, 88vh);
  --settings-window-radius: 12px;
  --settings-window-padding: 18px;
  --settings-window-gap: 18px;
  --settings-sidebar-width: 220px;
  --kt-color-component-settings-backdrop: var(--kt-color-alpha-black-20);
  --kt-color-component-settings-surface: #0f1114;
  --kt-color-component-settings-surface-strong: #0b0d10;
  --kt-color-component-settings-surface-elevated: #13161b;
  --kt-color-component-settings-border: var(--kt-color-alpha-white-08);
  --kt-color-component-settings-nav-hover: var(--kt-color-alpha-white-04);
  --kt-color-component-settings-nav-active: var(--kt-color-alpha-white-12);
  --kt-color-component-settings-card-bg: #161a20;
  --kt-color-component-settings-card-border: var(--kt-color-alpha-white-06);
  --kt-color-component-settings-row-hover: var(--kt-color-alpha-white-04);
  --kt-color-component-settings-input-bg: #0f1216;
  --kt-color-component-settings-input-border: var(--kt-color-alpha-white-12);
  --kt-color-component-settings-accent: var(--kt-color-accent-primary);
  --kt-color-component-settings-conflict-border: rgba(248, 113, 113, 0.6);
  --kt-color-component-settings-conflict-glow: rgba(248, 113, 113, 0.2);
  --kt-color-component-settings-conflict-text: rgba(248, 113, 113, 0.85);

  /* Component: toast */
  --kt-color-component-toast-success-bg: linear-gradient(135deg, #10b981 0%, #059669 100%);
  --kt-color-component-toast-success-shadow: 0 4px 20px rgba(16, 185, 129, 0.4),
    0 2px 8px rgba(0, 0, 0, 0.3);
  --kt-color-component-toast-error-bg: rgba(24, 16, 16, 0.95);
  --kt-color-component-toast-error-border: rgba(239, 68, 68, 0.35);
  --kt-color-component-toast-neutral-bg: rgba(50, 50, 55, 0.95);
  --kt-color-component-toast-neutral-border: var(--kt-color-alpha-white-16);
  --kt-color-component-toast-neutral-text: var(--kt-color-alpha-white-90);

  /* Component: onboarding */
  --kt-color-component-onboarding-scrim: var(--kt-color-alpha-black-50);
  --kt-color-component-onboarding-window-bg: #1c1c1e;
  --kt-color-component-onboarding-text: var(--kt-color-text-emphasis);
  --kt-color-component-onboarding-text-muted: #98989f;
  --kt-color-component-onboarding-border: var(--kt-color-alpha-white-08);
  --kt-color-component-onboarding-status-success: #30d158;
  --kt-color-component-onboarding-status-error: #ff453a;
  --kt-color-component-onboarding-status-info: #98989f;
  --kt-color-component-onboarding-button-primary-bg: var(--kt-color-accent-primary);
  --kt-color-component-onboarding-button-primary-border: var(--kt-color-accent-primary-strong);
  --kt-color-component-onboarding-button-primary-hover: var(--kt-color-accent-primary-strong);
  --kt-color-component-onboarding-button-secondary-hover: #bbbbbb;
  --kt-color-component-onboarding-gradient: linear-gradient(90deg, #f06292, #ba68c8, #42a5f5, #26c6da, #d4e157, #f06292);

  /* Component: terminal chrome */
  --kt-color-component-terminal-chrome-text-muted: rgba(200, 200, 216, 0.4);
  --kt-color-component-terminal-chrome-text: rgba(200, 200, 216, 0.5);
  --kt-color-component-terminal-chrome-text-strong: rgba(200, 200, 216, 0.8);
  --kt-color-component-terminal-chrome-text-faint: rgba(200, 200, 216, 0.3);
  --kt-color-component-terminal-chrome-bg: rgba(255, 255, 255, 0.03);
  --kt-color-component-terminal-chrome-border: var(--kt-color-alpha-white-06);
  --kt-color-component-terminal-chrome-close-hover-bg: rgba(255, 100, 100, 0.2);
  --kt-color-component-terminal-chrome-close-hover-text: rgba(255, 150, 150, 0.9);
  --kt-color-component-terminal-inactive-overlay: var(--kt-color-alpha-black-50);
  --kt-color-component-terminal-loading-overlay: rgba(8, 8, 12, 0.6);
  --kt-color-component-terminal-loading-text: rgba(225, 225, 240, 0.75);
  --kt-color-component-terminal-loading-ring: rgba(225, 225, 240, 0.35);
  --kt-color-component-terminal-loading-ring-top: rgba(225, 225, 240, 0.85);

  /* Component: popovers / tooltips */
  --kt-color-component-popover-bg: rgba(10, 10, 10, 0.95);
  --kt-color-component-tooltip-bg: rgba(30, 30, 35, 0.95);
  --kt-color-component-tooltip-bg-gradient: linear-gradient(180deg, rgba(28, 28, 32, 0.96), rgba(20, 20, 24, 0.94));
  --kt-color-component-tooltip-bg-muted: rgba(20, 20, 24, 0.8);

  /* Component: search */
  --kt-color-component-search-highlight-bg: #f6e05e;
  --kt-color-component-search-highlight-text: #1b1b1b;

  /* Component: drag */
  --kt-color-component-drag-hint-bg: var(--kt-color-accent-primary-weak);

  /* Component: badges */
  --kt-color-component-badge-bg: var(--kt-color-alpha-white-08);
  --kt-color-component-badge-text: rgba(240, 240, 250, 0.9);
  --kt-color-component-badge-codex-bg: var(--kt-color-alpha-white-90);
  --kt-color-component-badge-codex-text: var(--kt-color-base-neutral-40);
  --kt-color-component-badge-claude-bg: #da7756;
  --kt-color-component-badge-claude-text: var(--kt-color-text-emphasis);

  /* Component: preview */
  --kt-color-component-preview-bg: rgba(13, 17, 23, 0.98);
  --kt-color-component-preview-header-bg: rgba(22, 27, 34, 0.8);

  /* Component: status debug */
  --kt-color-component-debug-bg: rgba(15, 17, 20, 0.88);
  --kt-color-component-debug-text: #eef2f6;

  /* Component: markdown */
  --kt-color-component-markdown-text: var(--kt-color-syntax-text);
  --kt-color-component-markdown-heading: var(--kt-color-text-emphasis);
  --kt-color-component-markdown-link: #58a6ff;
  --kt-color-component-markdown-code-bg: rgba(110, 118, 129, 0.25);
  --kt-color-component-markdown-pre-bg: rgba(22, 27, 34, 0.9);
  --kt-color-component-markdown-quote-border: #3b434b;
  --kt-color-component-markdown-table-bg: rgba(22, 27, 34, 0.6);
  --kt-color-component-markdown-table-alt: rgba(22, 27, 34, 0.3);

  /* Component: patterns */
  --kt-color-component-pattern-checker: repeating-conic-gradient(#1a1a1a 0% 25%, #0a0a0a 0% 50%) 50% / 16px 16px;

  /* Icons / cursors (data-uri) */
  --kt-icon-status-check: url("data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%2012%2012%27%20fill%3D%27none%27%20stroke%3D%27black%27%20stroke-width%3D%272%27%20stroke-linecap%3D%27round%27%20stroke-linejoin%3D%27round%27%3E%3Cpath%20d%3D%27M2%206.5%204.8%209%2010%203%27/%3E%3C/svg%3E");
  --kt-icon-status-check-read: url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%20%3Cpath%20d%3D'M13%2C5.28671%2C6.18205%2C12%2C3%2C8.86709l1.36346-1.343%2C1.87517%2C1.8462L11.69312%2C4Z'%2F%3E%20%3C%2Fsvg%3E");
  --kt-icon-status-check-unread: url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2016%2016'%3E%20%3Ccircle%20cx%3D'12.5'%20cy%3D'11.50003'%20r%3D'1.5'%2F%3E%20%3Cpath%20d%3D'M14%2C4.693%2C5.81846%2C12.87529%2C2%2C9.05683%2C3.63615%2C7.4199l2.2502%2C2.25019%2C6.54538-6.54538Z'%2F%3E%20%3C%2Fsvg%3E");
  --kt-icon-status-question: url("data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%2012%2012%27%20fill%3D%27none%27%20stroke%3D%27black%27%20stroke-width%3D%271.8%27%20stroke-linecap%3D%27round%27%20stroke-linejoin%3D%27round%27%3E%3Cpath%20d%3D%27M4.2%204.2C4.2%202.9%205.2%202%206.3%202c1.2%200%202.1.8%202.1%201.9%200%201.1-.6%201.6-1.5%202.1-.8.4-1%20.7-1%201.5%27/%3E%3Ccircle%20cx%3D%276.1%27%20cy%3D%279.6%27%20r%3D%270.9%27%20fill%3D%27black%27%20stroke%3D%27none%27/%3E%3C/svg%3E");
  --kt-icon-folder-muted: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23777' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z'/%3E%3C/svg%3E");
  --kt-icon-folder-strong: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z'/%3E%3C/svg%3E");
  --kt-cursor-resize-ns: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M10 3L6.5 7h7L10 3z' fill='%23a0a8b2'/%3E%3Cpath d='M10 17l3.5-4h-7l3.5 4z' fill='%23a0a8b2'/%3E%3Ccircle cx='10' cy='10' r='1.5' fill='%23a0a8b2'/%3E%3C/svg%3E") 10 10, ns-resize;

  /* Typography */
  --kt-type-ui-fontFamily: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --kt-type-mono-fontFamily: 'HackGen Console NF', Consolas, monospace;
  --kt-type-ui-size-xs: 11px;
  --kt-type-ui-size-s: 12px;
  --kt-type-ui-size-m: 13px;
  --kt-type-ui-size-l: 14px;
  --kt-type-ui-size-xl: 16px;
  --kt-type-ui-weight-regular: 400;
  --kt-type-ui-weight-medium: 500;
  --kt-type-ui-weight-bold: 600;
  --kt-type-ui-lineHeight-tight: 1.3;
  --kt-type-ui-lineHeight-normal: 1.5;
  --kt-type-ui-lineHeight-loose: 1.7;
  --kt-type-mono-size-s: 12px;
  --kt-type-mono-size-m: 13px;
  --kt-type-mono-size-l: 14px;
  --kt-type-mono-lineHeight-normal: 1.5;

  /* Space / radius / shadow */
  --kt-space-2: 2px;
  --kt-space-4: 4px;
  --kt-space-8: 8px;
  --kt-space-12: 12px;
  --kt-space-16: 16px;
  --kt-space-24: 24px;
  --kt-space-32: 32px;
  --kt-space-40: 40px;
  --kt-space-48: 48px;
  --kt-space-64: 64px;

  --kt-radius-xs: 3px;
  --kt-radius-s: 4px;
  --kt-radius-m: 6px;
  --kt-radius-l: 8px;
  --kt-radius-xl: 12px;
  --kt-radius-pill: 999px;

  --kt-shadow-1: 0 4px 16px rgba(0, 0, 0, 0.4);
  --kt-shadow-2: 0 8px 32px rgba(0, 0, 0, 0.5);
  --kt-shadow-3: 0 12px 30px rgba(0, 0, 0, 0.5);
  --kt-shadow-4: 0 30px 80px rgba(0, 0, 0, 0.55);
  --kt-shadow-focus: 0 0 0 2px var(--kt-color-state-focus-ring);
}

html, body {
  height: 100%;
  overflow: hidden;
  background-color: var(--kt-color-bg-canvas);
  font-family: var(--kt-type-ui-fontFamily);
  color: var(--kt-color-text-primary);
}

:root.terminal-searching {
  --kt-color-terminal-selection-inactive: var(--kt-color-terminal-ansi-yellow);
}

/* カスタムスクロールバー */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--kt-color-scrollbar-thumb);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--kt-color-scrollbar-thumb-hover);
}

/* カスタムタイトルバー（タブ統合） */
.titlebar {
  display: flex;
  align-items: center;
  height: var(--titlebar-height);
  background: var(--kt-color-bg-surface);
  border-bottom: 1px solid var(--kt-color-border-default);
  user-select: none;
  position: relative;
  -webkit-app-region: drag;
  flex-shrink: 0;
  grid-column: 3;
  grid-row: 1;
}

/* Windows最大化/全画面時: タブを上端まで使えるようにする */
body.window-maximized .titlebar.win,
body.window-fullscreen .titlebar.win {
  padding-top: 0;
  height: var(--titlebar-height);
}

body.window-maximized .titlebar.win .titlebar-tabs-wrapper,
body.window-fullscreen .titlebar.win .titlebar-tabs-wrapper {
  height: 100%;
}

body.window-maximized .titlebar.win .titlebar-tabs,
body.window-fullscreen .titlebar.win .titlebar-tabs {
  height: 100%;
}

body.window-maximized .titlebar.win .terminal-tab,
body.window-fullscreen .titlebar.win .terminal-tab {
  height: 100%;
}

/* タイトルバー内タブ領域 (Chrome風スクロール対応) */
.titlebar-tabs-wrapper {
  display: flex;
  align-items: center;
  flex: 0 1 auto;
  min-width: 0;
  max-width: calc(100% - 180px);
  position: relative;
  -webkit-app-region: no-drag;
  height: 100%;
}

.titlebar-tabs {
  display: flex;
  align-items: stretch;
  gap: 0;
  padding: 0;
  -webkit-app-region: no-drag;
  overflow-x: hidden;
  overflow-y: hidden;
  flex: 0 1 auto;
  min-width: 0;
  scroll-behavior: smooth;
  position: relative;
  height: 100%;
}


.titlebar-tabs.scrollable {
  overflow-x: auto;
}

.titlebar-tabs::-webkit-scrollbar {
  display: none;
}

/* タブスクロールボタン */
.tab-scroll-btn {
  display: none;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 100%;
  border: none;
  background: var(--kt-color-bg-surface);
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  flex-shrink: 0;
  -webkit-app-region: no-drag;
  z-index: 2;
  transition: color 0.15s, background 0.15s;
}

.tab-scroll-btn:hover {
  color: var(--kt-color-text-primary);
  background: var(--kt-color-bg-elevated);
}

.tab-scroll-btn.visible {
  display: flex;
}

.tab-scroll-btn svg {
  width: 12px;
  height: 12px;
}

.tab-scroll-left {
  border-radius: 4px 0 0 4px;
  margin-right: 2px;
}

.tab-scroll-right {
  border-radius: 0 4px 4px 0;
  margin-left: 2px;
}

/* ドラッグ領域（タブとボタンの間） */
.titlebar-drag {
  flex: 1;
  height: 100%;
  min-width: 40px;
  /* drag is inherited from .titlebar */
}

.titlebar-buttons {
  display: flex;
  -webkit-app-region: no-drag;
  flex-shrink: 0;
}

/* === Windows/Linux スタイル === */
.titlebar.win .titlebar-tabs-wrapper {
  order: 0;
}

.titlebar.win .titlebar-drag {
  order: 1;
}

.titlebar.win .titlebar-buttons {
  order: 2;
}

.titlebar.win .titlebar-button {
  width: 46px;
  height: 36px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  font-size: 10px;
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
  font-family: 'Segoe MDL2 Assets', sans-serif;
}

.titlebar.win .titlebar-button:hover {
  background: var(--kt-color-bg-elevated);
  color: var(--kt-color-text-primary);
}

.titlebar.win .titlebar-button.close:hover {
  background: var(--kt-color-status-error);
  color: white;
}

/* === macOS スタイル === */
/* macOSではネイティブトラフィックライトボタンが表示されるのでカスタムボタンを非表示 */
.titlebar.mac .titlebar-buttons {
  display: none;
}

.titlebar.mac .titlebar-tabs-wrapper {
  order: 0;
  padding-left: 0;
}

.titlebar.mac .titlebar-drag {
  order: 1;
}

/* === Window resize handles === */
.window-resize-handle {
  position: fixed;
  z-index: 4000;
  background: transparent;
  -webkit-app-region: no-drag;
}

body.window-maximized .window-resize-handle,
body.window-fullscreen .window-resize-handle {
  display: none;
}

.window-resize-handle.n,
.window-resize-handle.s {
  left: 8px;
  right: 8px;
  height: 6px;
}

.window-resize-handle.e,
.window-resize-handle.w {
  top: 8px;
  bottom: 8px;
  width: 6px;
}

.window-resize-handle.n { top: 0; cursor: ns-resize; }
.window-resize-handle.s { bottom: 0; cursor: ns-resize; }
.window-resize-handle.e { right: 0; cursor: ew-resize; }
.window-resize-handle.w { left: 0; cursor: ew-resize; }

.window-resize-handle.ne,
.window-resize-handle.nw,
.window-resize-handle.se,
.window-resize-handle.sw {
  width: 8px;
  height: 8px;
}

.window-resize-handle.ne { top: 0; right: 0; cursor: nesw-resize; }
.window-resize-handle.nw { top: 0; left: 0; cursor: nwse-resize; }
.window-resize-handle.se { bottom: 0; right: 0; cursor: nwse-resize; }
.window-resize-handle.sw { bottom: 0; left: 0; cursor: nesw-resize; }

/* デバッグメニュー */
.debug-menu {
  display: none;
  position: absolute;
  top: 44px;
  right: 10px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 8px;
  padding: 8px 0;
  z-index: 1000;
  box-shadow: 0 4px 16px var(--kt-color-alpha-black-50);
}

.debug-menu.show {
  display: block;
}

.debug-menu-item {
  padding: 8px 16px;
  color: var(--kt-color-text-primary);
  font-size: 12px;
  cursor: pointer;
  white-space: nowrap;
}

.debug-menu-item:hover {
  background: var(--kt-color-bg-elevated);
}

.debug-menu-item.active::before {
  content: '✓ ';
  color: var(--kt-color-status-success);
}

.debug-menu-divider {
  height: 1px;
  background: var(--kt-color-border-default);
  margin: 6px 0;
}

/* Terminal health (debug) */
.terminal-health-panel {
  position: absolute;
  top: 44px;
  right: 10px;
  min-width: 240px;
  padding: 10px 12px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 10px;
  box-shadow: 0 12px 30px var(--kt-color-alpha-black-50);
  display: none;
  z-index: 1001;
}

.terminal-health-panel.show {
  display: block;
}

.terminal-health-title {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  font-size: 11px;
  color: var(--kt-color-text-primary);
  margin-bottom: 6px;
  letter-spacing: 0.3px;
}

.terminal-health-refresh {
  width: 22px;
  height: 20px;
  border-radius: 6px;
  border: 1px solid var(--kt-color-component-button-ghost-border);
  background: var(--kt-color-component-button-ghost-bg);
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  font-size: 12px;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}

.terminal-health-refresh:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  border-color: var(--kt-color-component-button-ghost-hover-border);
  color: var(--kt-color-text-primary);
}

.terminal-health-body {
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  white-space: pre-wrap;
  line-height: 1.4;
}

/* メインコンテナ */
.container {
  display: grid;
  grid-template-columns: auto 1px 1fr;
  grid-template-rows: var(--titlebar-height) 1fr;
  height: calc(100vh - var(--status-bar-height, 28px));
  width: 100vw;
  position: relative;
  /* Hide initially to prevent layout jarring during restoration */
  opacity: 0;
  transition: opacity 0.15s ease-out;
}

.container.ready {
  opacity: 1;
}

/* ========================================
   ステータスバー（アバター＋応援メッセージ）
   ======================================== */
.status-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--status-bar-height);
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0 8px;
  background: var(--kt-color-bg-elevated);
  border-top: 1px solid var(--kt-color-border-default);
  z-index: 100;
}

.status-bar-avatar {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  overflow: hidden;
  flex-shrink: 0;
  background: var(--kt-color-bg-surface);
  border: 1px solid var(--kt-color-border-default);
}

.status-bar-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.status-bar-message {
  flex: 1;
  font-size: 12px;
  color: var(--kt-color-text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.status-bar-message.show {
  opacity: 1;
}

.status-bar-message.fade-out {
  opacity: 0;
}

.status-bar-settings {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: 4px;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  flex-shrink: 0;
  transition: all 0.15s;
}

.status-bar-settings:hover {
  background: var(--kt-color-bg-surface);
  color: var(--kt-color-text-primary);
}

.status-bar-settings.active {
  background: var(--kt-color-text-secondary);
  color: white;
}


/* アバターホバーポップアップ */
.avatar-popup {
  position: fixed;
  bottom: 40px;
  left: 8px;
  display: flex;
  align-items: flex-end;
  gap: 12px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(8px);
  transition: opacity 0.2s ease, transform 0.2s ease;
  z-index: 200;
}

.avatar-popup.show {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

.avatar-popup-container {
  width: 120px;
  height: 120px;
  border-radius: 12px;
  overflow: hidden;
  background: var(--kt-color-bg-surface);
  border: 1px solid var(--kt-color-border-default);
  box-shadow: 0 8px 32px var(--kt-color-alpha-black-50);
}

.avatar-popup-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  image-rendering: pixelated;
}

.avatar-popup-bubble {
  max-width: 280px;
  padding: 10px 14px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 12px;
  color: var(--kt-color-text-primary);
  font-size: 13px;
  line-height: 1.5;
  box-shadow: 0 8px 32px var(--kt-color-alpha-black-50);
  word-wrap: break-word;
}

.avatar-popup-bubble:empty {
  display: none;
}

/* ターミナル */
.terminal-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  background-color: var(--kt-color-terminal-bg);
  padding: 0;
  overflow: hidden;
  min-height: 0; /* flex子要素が正しく縮小するために必要 */
  min-width: 0; /* flexbox縮小を許可 */
  position: relative;
  --terminal-stack-offset: 0px;
  grid-column: 3;
  grid-row: 2;
}

/* ========================================
   Left Activity Bar + Pane
   ======================================== */

.left-topbar {
  grid-column: 1 / 3;
  grid-row: 1;
  display: flex;
  height: var(--titlebar-height);
  background: var(--kt-color-bg-surface);
  border-bottom: 1px solid var(--kt-color-border-default);
  border-right: 1px solid var(--kt-color-border-default);
  -webkit-app-region: drag;
}

.activity-bar-top {
  width: var(--activity-bar-width);
  height: 100%;
  flex-shrink: 0;
}

.left-pane-top {
  flex: 1;
  min-width: 0;
}

.left-shell {
  grid-column: 1;
  grid-row: 2;
  display: flex;
  flex-direction: row;
  height: 100%;
  min-height: 0;
  flex-shrink: 0;
  min-width: 0;
  overflow: hidden;
  position: relative;
  background: var(--kt-color-bg-surface);
}

.activity-bar {
  width: var(--activity-bar-width);
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  background: linear-gradient(180deg, var(--kt-color-component-session-pane-bg-strong), var(--kt-color-component-session-pane-bg-muted));
  border-right: 0;
}

.activity-bar-body {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: 0;
  padding: 0;
  flex: 1;
  min-height: 0;
  border-right: 1px solid var(--kt-color-component-session-pane-border);
}

.activity-item {
  width: 100%;
  height: var(--activity-bar-width);
  border-radius: 0;
  border: 1px solid transparent;
  background: transparent;
  color: var(--kt-color-text-secondary);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background 0.12s ease, color 0.12s ease, border-color 0.12s ease;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  appearance: none;
  -webkit-appearance: none;
}

.activity-item svg {
  width: 24px;
  height: 24px;
}

.activity-item[data-pane="active"] svg {
  width: 18px;
  height: 18px;
}

.activity-item[data-pane="history"] svg {
  width: 25px;
  height: 25px;
}

.activity-item[data-pane="history"] svg path {
  stroke-width: 1.4;
}

.activity-item:hover {
  background: var(--kt-color-component-session-pane-hover);
  color: var(--kt-color-text-primary);
  border-color: var(--kt-color-component-session-pane-border-subtle);
}

.activity-item.active {
  background: var(--kt-color-component-session-pane-item-active);
  color: var(--kt-color-text-primary);
  border-color: var(--kt-color-component-session-pane-border);
}

.activity-spacer {
  flex: 1;
}

.activity-item.activity-settings {
  margin-top: auto;
  margin-bottom: 0;
}

.left-pane {
  width: 360px;
  min-width: 180px;
  max-width: 760px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  background: var(--kt-color-component-session-pane-bg);
  border-right: 0;
  transition: none;
  opacity: 1;
  min-height: 0;
  position: relative;
  height: 100%;
}

.left-pane[aria-hidden="true"] {
  width: 0;
  min-width: 0;
  max-width: 0;
  opacity: 0;
  pointer-events: none;
  border-right: 0;
  overflow: hidden;
}

.left-pane-panel {
  flex: 1;
  display: none;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
  height: 100%;
}

.left-pane-panel.active {
  display: flex;
}

/* ========================================
   Session Sidebar
   ======================================== */

.session-sidebar {
  width: 100%;
  min-width: 0;
  max-width: none;
  flex: 1;
  display: flex;
  flex-direction: column;
  background: var(--kt-color-component-session-pane-bg);
  border-right: 0;
  transition: none;
  transform: translateX(0);
  opacity: 1;
  min-height: 0;
  height: 100%;
}

body:not(.session-sidebar-focused) .left-pane {
  --kt-color-text-primary: var(--kt-color-component-session-pane-text-primary);
  --kt-color-text-secondary: var(--kt-color-component-session-pane-text-secondary);
  --kt-color-text-faint: var(--kt-color-component-session-pane-text-faint);
}

.session-sidebar[aria-hidden="true"] {
  transform: translateX(-100%);
  opacity: 0;
  pointer-events: none;
  width: 0;
  min-width: 0;
  flex-basis: 0;
  border-right: 0;
  overflow: hidden;
}

.session-sidebar-resizer {
  width: 1px;
  flex: 0 0 1px;
  margin: 0;
  cursor: col-resize;
  position: relative;
  background: transparent;
  touch-action: none;
  z-index: 5;
  grid-column: 2;
  grid-row: 2;
}

.session-sidebar-resizer::before {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--kt-color-border-default);
}

.session-sidebar-resizer::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: -4px;
  right: -4px;
}

body.left-pane-hidden .session-sidebar-resizer {
  position: relative;
  top: auto;
  bottom: auto;
  left: auto;
  border: 0;
  box-shadow: none;
  cursor: col-resize;
  z-index: 5;
}

.session-sidebar-resizer-icon,
.session-sidebar-resizer-label {
  display: none;
}

body.left-pane-hidden .session-sidebar-resizer .session-sidebar-resizer-icon {
  display: none;
}

.session-sidebar-resizer-icon {
  position: absolute;
  top: 10px;
  left: 9px;
  width: 10px;
  height: 10px;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  color: var(--kt-color-text-primary);
  opacity: 0.9;
}

.session-sidebar-resizer-label {
  position: absolute;
  bottom: 8px;
  left: 4px;
  font-size: 9px;
  letter-spacing: 0.1em;
  color: var(--kt-color-text-secondary);
  opacity: 0.85;
}

body.left-pane-hidden .session-sidebar-resizer:hover {
  background: var(--kt-color-border-default);
}

body.session-sidebar-resizing {
  cursor: col-resize;
  user-select: none;
}

.session-sidebar-header {
  display: flex;
  align-items: center;
  gap: 8px;
  height: var(--titlebar-height);
  padding: 0 12px;
  border-bottom: 1px solid var(--kt-color-border-default);
  flex-shrink: 0;
}

.session-sidebar-toggle {
  width: 24px;
  height: 24px;
  padding: 4px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  border-radius: 4px;
  transition: background 0.15s ease, color 0.15s ease;
}

.session-sidebar-toggle:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  color: var(--kt-color-text-primary);
}

.session-sidebar-title {
  font-size: 11px;
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
  opacity: 0.7;
  flex: 1;
}

.session-sidebar-count {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  opacity: 0.5;
}

.session-sidebar-body {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0; /* CRITICAL: flexboxで正しくスクロールするため */
  padding: 0 0 8px;
  background: var(--kt-color-component-session-pane-bg);
  --session-group-header-height: 28px;
}

/* スクロールバースタイル */
.session-sidebar-body::-webkit-scrollbar {
  width: 4px;
}

.session-sidebar-body::-webkit-scrollbar-track {
  background: transparent;
}

.session-sidebar-body::-webkit-scrollbar-thumb {
  background: var(--kt-color-component-session-pane-scrollbar);
  border-radius: 4px;
}

.session-sidebar-body::-webkit-scrollbar-thumb:hover {
  background: var(--kt-color-component-session-pane-scrollbar-hover);
}

/* ========================================
   Search Pane
   ======================================== */

.session-sidebar-search {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 8px 10px 6px;
  border-bottom: 1px solid var(--kt-color-component-session-pane-border);
  background: var(--kt-color-component-session-pane-bg);
}

.session-sidebar-search-input {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 8px;
  border-radius: var(--left-pane-card-radius, 8px);
  background: var(--kt-color-component-session-card-bg);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  color: var(--kt-color-text-primary);
}

.session-sidebar-search-input svg {
  color: var(--kt-color-text-secondary);
  flex-shrink: 0;
}

.session-sidebar-search-input input {
  flex: 1;
  min-width: 0;
  border: none;
  outline: none;
  background: transparent;
  color: var(--kt-color-text-primary);
  font-size: 12px;
  font-family: inherit;
}

.session-sidebar-search-input input::placeholder {
  color: var(--kt-color-text-secondary);
  opacity: 0.6;
}

.session-sidebar-search-clear {
  width: 18px;
  height: 18px;
  border-radius: 4px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.12s ease, color 0.12s ease, background 0.12s ease;
}

.session-sidebar-search-clear.is-visible {
  opacity: 0.7;
  pointer-events: auto;
}

.session-sidebar-search-clear:hover {
  color: var(--kt-color-text-primary);
  background: var(--kt-color-component-button-ghost-hover-bg);
}

.session-sidebar-search-status {
  min-height: 12px;
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  opacity: 0.7;
}

.session-search-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.search-highlight {
  background: var(--kt-color-component-search-highlight-bg);
  color: var(--kt-color-component-search-highlight-text);
  padding: 0 2px;
  border-radius: 3px;
}

/* ========================================
   Session Groups (CWD Grouping)
   ======================================== */

.session-group-list {
  display: flex;
  flex-direction: column;
  gap: 0;
  padding-top: 0;
}

.session-section {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.session-section + .session-section {
  margin-top: 14px;
}

.session-section-header {
  display: flex;
  align-items: center;
  padding: 6px 6px 2px;
}

.session-section.is-hidden {
  display: none;
}

.session-section.is-compact .session-section-header {
  display: none;
}

.session-section.is-compact {
  margin-top: 0;
}

.session-section-empty {
  display: block;
  padding: 12px 12px 8px;
  border-radius: 0;
  border: 0;
  color: var(--kt-color-text-secondary);
  font-size: 11px;
  letter-spacing: 0.04em;
  opacity: 0.65;
  text-align: center;
}

.session-section-empty::before,
.session-section-empty::after {
  content: none;
}

.session-group {
  display: flex;
  flex-direction: column;
  border-radius: var(--left-pane-card-radius, 8px);
  overflow: visible;
}

.session-group-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 14px 12px;
  background: var(--kt-color-bg-elevated);
  border: none;
  border-top: 1px solid var(--kt-color-border-subtle);
  border-bottom: 1px solid var(--kt-color-border-subtle);
  border-radius: var(--left-pane-card-radius, 0px);
  cursor: pointer;
  transition: none;
  user-select: none;
  font-weight: 600;
  margin: 0;
  padding-left: 8px;
}

.session-group-header:hover {
  background: var(--kt-color-bg-elevated);
  opacity: 0.8;
}

.session-group-header:active {
  background: var(--kt-color-bg-elevated);
  opacity: 0.6;
}

.session-group-icon {
  width: 14px;
  height: 14px;
  flex-shrink: 0;
  color: var(--kt-color-text-secondary);
  transition: none;
}

.session-group.open .session-group-icon {
  transform: rotate(90deg);
}

.session-group-cwd {
  flex: 1;
  font-size: 16px;
  line-height: 1.3;
  font-weight: 500;
  color: var(--kt-color-text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-left: 17px;
  background: var(--kt-icon-folder-muted) no-repeat left 50%;
  background-size: 14px 14px;
}

.session-group-badge {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  opacity: 0.6;
}

.session-group-body {
  display: flex;
  flex-direction: column;
  gap: 0;
  padding: 0;
  max-height: 0;
  overflow: hidden;
  transition: none;
  opacity: 0;
}

.session-group.open .session-group-body {
  max-height: none;
  padding: 0;
  opacity: 1;
  overflow: visible;
}

/* ========================================
   Session Items (in Sidebar)
   ======================================== */

.session-item {
  position: relative;
  padding: 12px 10px;
  margin: 0 0 0 12px;
  background: transparent;
  border: none;
  border-radius: 0;
  border-bottom: 1px solid var(--kt-color-border-subtle);
  cursor: pointer;
  transition: none;
}

.session-item.active {
  background: transparent;
}

.session-item-header {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 0;
}

.session-item-toggle {
  width: 100%;
  min-height: 26px;
  padding: 0 8px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  flex-shrink: 0;
  transition: none;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  letter-spacing: normal;
  border-radius: 0 0 4px 4px;
}

.session-item-toggle-left,
.session-item-toggle-right {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.session-item-toggle-right {
  margin-left: auto;
}

.session-item-toggle-target {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  height: auto;
  padding: 0;
  border-radius: 4px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  font-size: 11px;
  line-height: 1;
  position: relative;
  transition: none;
}

.session-item-toggle-target:hover {
  color: var(--kt-color-text-primary);
  background: transparent;
}

.session-item-toggle-target:active {
  transform: none;
}

.session-item-toggle-target:focus-visible {
  outline: 2px solid var(--kt-color-state-focus-ring);
  outline-offset: 1px;
}

.session-item.show-timeline .session-item-toggle-target {
  color: var(--kt-color-text-primary);
  background: transparent;
}
.session-item-toggle:hover {
  background: transparent;
  color: var(--kt-color-text-secondary);
  border-color: transparent;
}

.session-item.show-timeline .session-item-toggle {
  background: transparent;
  color: var(--kt-color-text-secondary);
  border-color: transparent;
}

.session-item-toggle-label {
  font-size: 11px;
  line-height: 1;
  letter-spacing: 0.08em;
}

.session-item-toggle-icon {
  width: 12px;
  height: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: none;
}

.session-item.show-timeline .session-item-toggle-icon {
  transform: rotate(180deg);
}

.session-item-footer {
  display: none;
}

.session-item.show-timeline .session-item-footer {
  border-top-color: transparent;
  align-items: flex-end;
}

.session-item.show-timeline .session-item-footer::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px;
  background: var(--kt-color-alpha-white-20);
  z-index: 0;
  pointer-events: none;
}

.session-item-toggle-source {
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 999px;
  font-weight: 600;
  letter-spacing: 0.06em;
  opacity: 0.85;
  background: transparent !important;
  color: var(--kt-color-text-secondary) !important;
  border: 1px solid var(--kt-color-alpha-white-08);
}

.session-item-toggle-ago {
  font-size: 11px;
  color: var(--kt-color-text-primary);
  opacity: 0.88;
}

.session-item-input {
  font-size: 13px;
  color: var(--kt-color-text-primary);
  line-height: 1.5;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-bottom: 0;
  flex: 1;
}

/* ========================================
   Session Timeline (nested in session-item)
   ======================================== */

.session-timeline {
  max-height: 0;
  overflow: hidden;
  transition: none;
  padding: 0;
  position: relative;
}

.session-item.show-timeline .session-timeline {
  max-height: none;
  margin-top: 2px;
  padding-top: 4px;
  padding-left: 6px;
  border-left: 1px solid var(--kt-color-border-subtle);
}


.session-timeline-entry {
  padding: 4px 6px;
  margin: 0 0 0 6px;
  background: transparent;
  border: none;
  border-radius: 0;
  font-size: 9px;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  transition: none;
}

.session-timeline-action {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 6px;
  font-size: 9px;
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
  opacity: 0.9;
}

.session-timeline-action-icon {
  width: 12px;
  height: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.session-timeline-action-icon svg {
  width: 12px;
  height: 12px;
}


.session-timeline-entry:hover {
  background: var(--kt-color-alpha-white-04);
}

.session-timeline-entry:last-child {
  margin-bottom: 0;
}

.session-timeline-input {
  font-size: 11px;
  color: var(--kt-color-text-primary);
  margin-bottom: 0;
  line-height: 1.4;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.session-timeline-output {
  display: none;
}

/* Empty/Loading States */
.session-sidebar-loading,
.session-sidebar-empty,
.session-timeline-loading,
.session-timeline-empty,
.session-timeline-error {
  padding: 12px 12px 8px;
  text-align: center;
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  opacity: 0.65;
}

.session-timeline-error {
  color: var(--kt-color-status-error);
}

/* Focus States for Accessibility */
.session-group-header:focus,
.session-item:focus,
.session-timeline-entry:focus {
  outline: 2px solid var(--kt-color-component-button-ghost-hover-border);
  outline-offset: 2px;
}

/* タイトルバー内タブアクション */
.terminal-tabs-actions {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  margin-left: 4px;
  flex-shrink: 0;
}

/* Chrome風タブ: 縮小対応 */
.terminal-tab {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 6px 8px 6px 12px;
  height: 100%;
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  border-radius: 0;
  border: 1px solid var(--kt-color-border-subtle);
  border-top: 0;
  border-bottom: 0;
  cursor: default;
  user-select: none;
  background: var(--kt-color-state-hover);
  transition: width 0.15s, opacity 0.12s, transform 0.12s, background 0.15s, color 0.15s, border-color 0.15s, box-shadow 0.2s, filter 0.2s;
  /* 明示的に幅を設定、flex-shrinkで縮小可能 */
  width: 280px;
  flex: 0 1 auto;
  min-width: 52px;
  overflow: hidden;
}

.terminal-tab + .terminal-tab {
  margin-left: -1px;
}

.titlebar-tabs .terminal-tab:first-of-type {
  border-left: 0;
}

.terminal-tab.has-unread-completion::before {
  content: '';
  position: absolute;
  left: 8px;
  right: 8px;
  bottom: 1px;
  height: 1px;
  border-radius: 999px;
  background: var(--kt-color-status-success);
  opacity: 0.7;
  pointer-events: none;
}

.terminal-tab-status-dot {
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: transparent;
  opacity: 0;
  margin-right: 4px;
  flex-shrink: 0;
  position: relative;
  transition: opacity 0.12s ease, transform 0.12s ease, box-shadow 0.12s ease;
}

.terminal-tab-status-dot.is-visible {
  opacity: 1;
}

@keyframes status-pulse {
  0% { opacity: 1; }
  50% { opacity: 0.35; }
  100% { opacity: 1; }
}

.terminal-tab-status-dot.status-working {
  background: var(--kt-color-status-info);
  box-shadow: 0 0 6px var(--kt-color-status-info-glow);
  animation: status-pulse 1.2s ease-in-out infinite;
}

.terminal-tab-status-dot.status-waiting_user {
  background: transparent;
  box-shadow: none;
  color: var(--kt-color-status-warning);
  --status-icon: var(--kt-icon-status-question);
}

.terminal-tab-status-dot.status-completed {
  background: transparent;
  box-shadow: none;
  color: var(--kt-color-status-success-weak);
  --status-icon: var(--kt-icon-status-check-read);
  --status-icon-scale: 110%;
}

.terminal-tab-status-dot.status-completed.is-unread {
  color: var(--kt-color-status-success);
  --status-icon: var(--kt-icon-status-check-unread);
  --status-icon-scale: 120%;
}

.terminal-tab-status-dot.status-waiting_user::after,
.terminal-tab-status-dot.status-completed::after {
  content: '';
  position: absolute;
  inset: -2px;
  background: currentColor;
  -webkit-mask-image: var(--status-icon);
  mask-image: var(--status-icon);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-size: var(--status-icon-scale, 120%) var(--status-icon-scale, 120%);
  mask-size: var(--status-icon-scale, 120%) var(--status-icon-scale, 120%);
}

.terminal-tab.is-resume-blink::after {
  content: '';
  position: absolute;
  inset: 2px 4px;
  border-radius: 6px;
  background: linear-gradient(120deg,
    transparent 0%,
    transparent 38%,
    var(--kt-color-alpha-white-32) 50%,
    transparent 62%,
    transparent 100%),
    linear-gradient(120deg,
      transparent 0%,
      transparent 38%,
      var(--kt-color-alpha-black-20) 50%,
      transparent 62%,
      transparent 100%);
  background-size: 220% 100%;
  pointer-events: none;
  opacity: 0;
  animation: tab-resume-glint 0.6s ease-out 0s 1 both;
}

.terminal-pane::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 10px;
  background-image:
    linear-gradient(120deg,
      transparent 0%,
      transparent 38%,
      var(--kt-color-alpha-white-24) 50%,
      transparent 62%,
      transparent 100%),
    linear-gradient(120deg,
      transparent 0%,
      transparent 38%,
      var(--kt-color-alpha-black-20) 50%,
      transparent 62%,
      transparent 100%);
  background-size: 240% 100%;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
  z-index: 5;
  filter: blur(8px);
  -webkit-mask-image: radial-gradient(120% 100% at 50% 50%, var(--kt-color-alpha-white-90) 58%, transparent 100%);
  mask-image: radial-gradient(120% 100% at 50% 50%, var(--kt-color-alpha-white-90) 58%, transparent 100%);
}

.terminal-pane.is-ghost-arrive {
  box-shadow: 0 0 18px var(--kt-color-alpha-white-24),
    0 0 46px var(--kt-color-status-info-glow);
}

.terminal-pane.is-ghost-arrive::before {
  animation: pane-glass-glint 0.7s ease-out 0s 1 both;
}

@keyframes pane-glass-glint {
  0% { opacity: 0; background-position: 120% 0; }
  22% { opacity: 0.9; }
  62% { opacity: 0.7; }
  100% { opacity: 0; background-position: -20% 0; }
}

@media (prefers-reduced-motion: reduce) {
  .terminal-pane::before {
    transition: none;
    animation: none;
  }
}

/* タブ閉じるアニメーション */
.terminal-tab.closing {
  width: 0 !important;
  min-width: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  opacity: 0;
  overflow: hidden;
  pointer-events: none;
}

.terminal-tab-split {
  display: none;
  width: 8px;
  height: 8px;
  border-radius: 2px;
  background: var(--kt-color-text-secondary);
  box-shadow: none;
}

.terminal-tab-split.show {
  display: inline-block;
}

.terminal-tab.dragging {
  opacity: 0.55;
  transform: translate(var(--drag-x, 0px), 0) scale(0.98);
  box-shadow: 0 6px 14px var(--kt-color-alpha-black-35);
  z-index: 3;
  transition: none;
}

.titlebar-tabs.dragging {
}

.titlebar-tabs.drag-target {
  background: var(--kt-color-state-hover);
}

.tab-drop-indicator {
  position: absolute;
  top: 4px;
  left: 0;
  width: 2px;
  height: 24px;
  border-radius: 999px;
  background: var(--kt-color-text-secondary);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.12s ease;
  will-change: transform;
}

.tab-drop-indicator.show {
  opacity: 1;
}

.tab-drag-ghost {
  position: fixed;
  top: 0;
  left: 0;
  transform: translate(-9999px, -9999px);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.12s ease;
  z-index: 9999;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  height: 26px;
  border-radius: 8px;
  background: var(--kt-color-bg-elevated);
  color: var(--kt-color-text-primary);
  border: 1px solid var(--kt-color-border-default);
  box-shadow: 0 10px 24px var(--kt-color-alpha-black-35);
  font-size: 11px;
  letter-spacing: 0.2px;
}

.tab-drag-ghost.show {
  opacity: 1;
}

.tab-drag-ghost-dot {
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: var(--kt-color-text-secondary);
  box-shadow: none;
  flex-shrink: 0;
}

.tab-drag-ghost-title {
  max-width: 220px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.terminal-tab:hover {
  background: var(--kt-color-state-active);
  color: var(--kt-color-text-primary);
  border-color: var(--kt-color-border-default);
}

.terminal-tab.active {
  color: var(--kt-color-text-primary);
  border-color: var(--kt-color-border-strong);
  background: var(--kt-color-state-selected);
}

@keyframes tab-resume-glint {
  0% { background-position: 120% 0; opacity: 0; }
  30% { opacity: 0.85; }
  70% { opacity: 0.75; }
  100% { background-position: -20% 0; opacity: 0; }
}

.terminal-tab.custom .terminal-tab-title::after {
  content: '•';
  margin-left: 6px;
  color: var(--kt-color-text-secondary);
  font-size: 10px;
}

.terminal-tab-title {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.terminal-tab-wsl {
  display: none;
  align-items: center;
  justify-content: center;
  padding: 1px 4px;
  border-radius: 999px;
  font-size: 9px;
  line-height: 1;
  letter-spacing: 0.4px;
  color: var(--kt-color-status-success);
  background: var(--kt-color-status-success-soft);
  border: 1px solid var(--kt-color-status-success-weak);
  flex-shrink: 0;
}

.terminal-tab.wsl .terminal-tab-wsl {
  display: inline-flex;
}

.terminal-tab.narrow .terminal-tab-wsl {
  display: none;
}

.terminal-tab.editing .terminal-tab-title,
.terminal-tab.editing .terminal-tab-close,
.terminal-tab.editing .terminal-tab-wsl {
  display: none;
}

.terminal-tab-rename {
  width: 160px;
  max-width: 160px;
  padding: 4px 6px;
  border-radius: 6px;
  border: 1px solid var(--kt-color-border-default);
  background: var(--kt-color-bg-surface);
  color: var(--kt-color-text-primary);
  font-size: 12px;
}

.terminal-tab-rename:focus {
  outline: none;
  border-color: var(--kt-color-text-secondary);
}

/* タブのショートカットキー表示 */
.terminal-tab-shortcut {
  font-size: 9px;
  color: var(--kt-color-component-terminal-chrome-text-muted);
  flex-shrink: 0;
  margin-left: auto;
  padding: 1px 4px;
  border-radius: 3px;
  background: var(--kt-color-alpha-white-04);
  font-family: var(--kt-type-mono-fontFamily);
  letter-spacing: 0.5px;
}

.terminal-tab-shortcut:empty {
  display: none;
}

/* タブが詰まったらショートカット非表示 */
.terminal-tab.compact .terminal-tab-shortcut {
  display: none;
}

/* 狭いタブではショートカット非表示 */
.terminal-tab.narrow .terminal-tab-shortcut {
  display: none;
}

.terminal-tab-close {
  border: none;
  background: transparent;
  color: inherit;
  font-size: 12px;
  cursor: pointer;
  padding: 2px;
  border-radius: 3px;
  flex-shrink: 0;
  opacity: 0.6;
  transition: opacity 0.15s, background 0.15s, color 0.15s;
}

.terminal-tab-close:hover {
  color: var(--kt-color-component-button-danger-text);
  background: var(--kt-color-component-button-ghost-hover-bg);
  opacity: 1;
}

/* 狭いタブでは閉じるボタンを非表示、ホバー時のみ表示 */
.terminal-tab.narrow .terminal-tab-close {
  display: none;
}

.terminal-tab.narrow:hover .terminal-tab-close {
  display: block;
  position: absolute;
  right: 4px;
  background: var(--kt-color-bg-surface);
  padding: 2px;
  border-radius: 3px;
}

.terminal-tab.narrow {
  position: relative;
  padding-right: 6px;
}

.terminal-tab.narrow:hover {
  padding-right: 20px;
}

.terminal-tab-add {
  width: 26px;
  height: 22px;
  border: none;
  border-radius: 6px;
  background: var(--kt-color-alpha-white-06);
  color: var(--kt-color-text-primary);
  font-size: 14px;
  cursor: pointer;
  transition: background 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  align-self: center;
  margin-left: 4px;
}

  .terminal-tab-add:hover {
    background: var(--kt-color-alpha-white-12);
  }

.terminal-tab-add-menu {
  width: 24px;
  height: 22px;
  border: none;
  border-radius: 6px;
  background: var(--kt-color-alpha-white-06);
  color: var(--kt-color-text-primary);
  cursor: pointer;
  transition: background 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  align-self: center;
}

  .terminal-tab-add-menu:hover {
    background: var(--kt-color-alpha-white-12);
  }

  .terminal-tab-add-menu svg {
    width: 10px;
    height: 10px;
  }

  .terminal-tab-add-menu.hidden {
    display: none;
  }

.terminal-stack {
  flex: 1;
  position: relative;
  overflow: hidden;
  min-height: 0;
}

.terminal-instance {
  position: absolute;
  inset: 0;
  display: flex;
  overflow: hidden;
  min-width: 0;
}

.terminal-pane-root {
  position: absolute;
  inset: 0;
  display: flex;
  min-width: 0;
  min-height: 0;
}

.terminal-pane-node {
  display: flex;
  flex: 1 1 0;
  min-width: 0;
  min-height: 0;
}

.terminal-pane-split {
  display: flex;
  flex: 1 1 0;
  min-width: 0;
  min-height: 0;
}

.terminal-pane-split[data-direction="row"] {
  flex-direction: row;
}

.terminal-pane-split[data-direction="col"] {
  flex-direction: column;
}

.terminal-pane {
  position: relative;
  display: flex;
  flex-direction: column;
  flex: 1 1 0;
  min-width: 0;
  min-height: 0;
  border-radius: 0;
  border: none;
  background: transparent;
  overflow: hidden;
}

.terminal-pane.active {
  border-color: transparent;
  box-shadow: none;
}

/* 非アクティブペインを暗くしてフォーカスを明確に */
.terminal-pane:not(.active)::after {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--kt-color-component-terminal-inactive-overlay);
  pointer-events: none;
  z-index: 10;
  transition: opacity 0.15s ease;
}

/* ペインヘッダー（ミニマルフラット） */
.terminal-pane-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 20px;
  padding: 0 6px;
  background: var(--kt-color-component-terminal-chrome-bg);
  border-bottom: 1px solid var(--kt-color-component-terminal-chrome-border);
  flex-shrink: 0;
  user-select: none;
  -webkit-app-region: no-drag;
}

.terminal-pane-summary {
  position: absolute;
  top: 4px;
  right: 6px;
  max-width: min(52%, 420px);
  padding: 6px 8px;
  border-radius: 8px;
  background: var(--kt-color-component-terminal-summary-bg);
  border: 1px solid var(--kt-color-component-terminal-summary-border);
  color: var(--kt-color-text-secondary);
  font-size: 11px;
  line-height: 1.35;
  z-index: 20;
  pointer-events: auto;
  backdrop-filter: blur(6px);
  white-space: pre-line;
  overflow: visible;
  transition: opacity 0.15s ease;
}

.terminal-pane-summary.is-empty {
  display: none;
}

.terminal-pane-summary:hover {
  opacity: 0;
}

.terminal-pane-summary-cwd {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 2px 6px;
  border-radius: 999px;
  background: var(--kt-color-component-terminal-summary-cwd-bg);
  border: 1px solid var(--kt-color-component-terminal-summary-cwd-border);
  color: var(--kt-color-component-terminal-summary-cwd-text);
  font-size: 10px;
  line-height: 1.2;
  margin-bottom: 6px;
  white-space: nowrap;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
}

.terminal-pane-summary-text {
  color: var(--kt-color-text-secondary);
  white-space: pre-line;
}

.terminal-pane-title {
  font-size: 10px;
  color: var(--kt-color-component-terminal-chrome-text);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
  min-width: 0;
}

.terminal-pane.active .terminal-pane-title {
  color: var(--kt-color-component-terminal-chrome-text-strong);
}

.terminal-pane-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border: none;
  background: transparent;
  color: var(--kt-color-component-terminal-chrome-text-faint);
  font-size: 12px;
  cursor: pointer;
  border-radius: 3px;
  padding: 0;
  margin-left: 4px;
  flex-shrink: 0;
  transition: background 0.1s, color 0.1s;
}

.terminal-pane-close:hover {
  background: var(--kt-color-component-terminal-chrome-close-hover-bg);
  color: var(--kt-color-component-terminal-chrome-close-hover-text);
}

.terminal-pane-content {
  display: flex;
  flex: 1 1 0;
  min-width: 0;
  min-height: 0;
}

.terminal-loading {
  position: absolute;
  top: 20px;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 12px;
  letter-spacing: 0.04em;
  color: var(--kt-color-component-terminal-loading-text);
  background: var(--kt-color-component-terminal-loading-overlay);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
  z-index: 3;
}

.terminal-loading::before {
  content: '';
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 2px solid var(--kt-color-component-terminal-loading-ring);
  border-top-color: var(--kt-color-component-terminal-loading-ring-top);
  animation: terminal-loading-spin 0.9s linear infinite;
}

.terminal-loading.show {
  opacity: 1;
}

.terminal-pane.terminal-loading-active .xterm-cursor-layer,
.terminal-pane.terminal-loading-active .xterm-cursor {
  opacity: 0 !important;
}

.terminal-pane.terminal-loading-active .xterm {
  opacity: 0 !important;
}

@keyframes terminal-loading-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.terminal-pane .xterm {
  flex: 1 1 0;
  min-width: 0;
}

.terminal-pane-resizer {
  flex: 0 0 2px;
  position: relative;
  background: var(--kt-color-alpha-white-08);
  z-index: 2;
  touch-action: none;
}

.terminal-pane-resizer[data-direction="row"] {
  cursor: col-resize;
}

.terminal-pane-resizer[data-direction="col"] {
  cursor: row-resize;
}

.terminal-pane-resizer::after {
  content: '';
  position: absolute;
  inset: -4px;
  background: transparent;
}

.terminal-pane-resizer:hover,
.terminal-pane-resizer.dragging,
body.pane-resizing .terminal-pane-resizer {
  background: var(--kt-color-text-secondary);
}

.terminal-split-ghost {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.12s ease;
  z-index: 40;
}

.terminal-split-ghost.show {
  opacity: 1;
}

.terminal-split-ghost-area {
  position: absolute;
  border-radius: 6px;
  background: var(--kt-color-state-hover);
  border: 1px solid var(--kt-color-border-default);
}

.terminal-split-ghost-line {
  position: absolute;
  background: var(--kt-color-text-secondary);
}

.terminal-instance .xterm {
  flex: 1;
  min-width: 0;
  overflow: hidden;
}

.terminal-instance .xterm-viewport {
  overflow-x: hidden;
}

/* ターミナル検索バー */
.terminal-search {
  --terminal-search-bg: var(--kt-color-component-popover-bg);
  --terminal-search-border: var(--kt-color-border-default);
  --terminal-search-input-bg: var(--kt-color-component-session-card-bg);
  --terminal-search-input-border: var(--kt-color-component-session-pane-border-subtle);
  --terminal-search-text: var(--kt-color-text-primary);
  --terminal-search-icon: var(--kt-color-text-secondary);
  --terminal-search-placeholder: var(--kt-color-text-secondary);
  position: absolute;
  top: calc(var(--terminal-stack-offset) + 6px);
  right: 12px;
  display: none;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  background: var(--terminal-search-bg);
  border: 1px solid var(--terminal-search-border);
  border-radius: 10px;
  z-index: 50;
  backdrop-filter: blur(8px);
}

.terminal-search.show {
  display: flex;
  --terminal-search-bg: var(--kt-color-component-session-pane-bg-strong);
  --terminal-search-border: var(--kt-color-component-session-pane-divider-strong);
  --terminal-search-input-bg: var(--kt-color-component-session-pane-active);
  --terminal-search-input-border: var(--kt-color-component-session-pane-divider-strong);
  --terminal-search-text: var(--kt-color-text-emphasis);
  --terminal-search-icon: var(--kt-color-text-emphasis);
}

.terminal-search-input {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 8px;
  border-radius: 8px;
  background: var(--terminal-search-input-bg);
  border: 1px solid var(--terminal-search-input-border);
  color: var(--terminal-search-text);
}

.terminal-search-input svg {
  color: var(--terminal-search-icon);
  flex-shrink: 0;
}

#terminal-search-input {
  width: 240px;
  min-width: 0;
  border: none;
  outline: none;
  background: transparent;
  color: var(--terminal-search-text);
  font-size: 12px;
  font-family: inherit;
}

#terminal-search-input::placeholder {
  color: var(--terminal-search-placeholder);
  opacity: 0.6;
}

.terminal-search-actions {
  display: flex;
  align-items: center;
  gap: 4px;
}

.terminal-search-status {
  min-width: 42px;
  padding-right: 2px;
  text-align: right;
  font-size: 11px;
  font-variant-numeric: tabular-nums;
  display: inline-flex;
  align-items: center;
  gap: 2px;
}

.terminal-search-status-current {
  color: var(--terminal-search-text);
}

.terminal-search-status-sep,
.terminal-search-status-total {
  color: var(--terminal-search-placeholder);
}

/* Preview panel toast */
.terminal-preview-toast {
  position: absolute;
  bottom: 16px;
  right: 16px;
  padding: 10px 16px;
  background: var(--kt-color-component-toast-neutral-bg);
  border: 1px solid var(--kt-color-component-toast-neutral-border);
  border-radius: 10px;
  color: var(--kt-color-component-toast-neutral-text);
  font-size: 12px;
  font-weight: 600;
  z-index: 10;
  opacity: 0;
  transform: translateY(12px) scale(0.9);
  pointer-events: none;
  transition: opacity 0.25s cubic-bezier(0.34, 1.56, 0.64, 1),
              transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-35);
  text-shadow: none;
  backdrop-filter: blur(8px);
}

.terminal-preview-toast.error {
  background: var(--kt-color-component-toast-error-bg);
  border: 1px solid var(--kt-color-component-toast-error-border);
  color: var(--kt-color-component-button-danger-text);
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-35);
  text-shadow: none;
}

.terminal-preview-toast.show {
  opacity: 1;
  transform: translateY(0) scale(1);
  animation: toast-pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.terminal-search-btn {
  width: 26px;
  height: 26px;
  border: 1px solid transparent;
  background: transparent;
  color: var(--kt-color-text-secondary);
  border-radius: 6px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: background 0.12s ease, color 0.12s ease, border-color 0.12s ease;
}

.terminal-search-btn:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  color: var(--kt-color-text-primary);
}

.terminal-search-btn.close {
  color: var(--kt-color-text-secondary);
}

.terminal-search-btn.close:hover {
  background: var(--kt-color-component-button-danger-bg);
  border-color: var(--kt-color-component-button-danger-border);
  color: var(--kt-color-component-button-danger-text);
}

/* ドラッグ&ドロップオーバーレイ */
.terminal-drop-overlay {
  position: absolute;
  top: var(--terminal-stack-offset);
  left: 8px;
  right: 8px;
  bottom: 8px;
  border: 2px dashed var(--kt-color-border-default);
  border-radius: 10px;
  background: var(--kt-color-state-hover);
  color: var(--kt-color-text-primary);
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  pointer-events: none;
  z-index: 40;
}

.terminal-drop-overlay.show {
  display: flex;
}

/* ターミナルコンテキストメニュー */
.terminal-context-menu {
  position: fixed;
  display: none;
  min-width: 160px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 8px;
  padding: 6px 0;
  z-index: 2000;
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-50);
}

.terminal-context-menu.show {
  display: block;
}

.context-menu-item {
  padding: 8px 14px;
  font-size: 12px;
  color: var(--kt-color-text-primary);
  cursor: pointer;
  white-space: nowrap;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.context-menu-item:hover {
  background: var(--kt-color-state-hover);
}

.context-menu-item.disabled {
  opacity: 0.5;
  cursor: default;
}

.context-menu-item.disabled:hover {
  background: transparent;
}

.context-menu-label {
  flex: 1;
  min-width: 0;
}

.context-menu-hint {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  font-family: var(--kt-type-mono-fontFamily);
  letter-spacing: 0.4px;
  opacity: 0.85;
  flex-shrink: 0;
}

.context-menu-item.disabled .context-menu-hint {
  opacity: 0.5;
}

.context-menu-hint:empty {
  display: none;
}

.context-menu-divider {
  height: 1px;
  background: var(--kt-color-border-default);
  margin: 6px 0;
}

.terminal-tab-menu {
  position: fixed;
  display: none;
  min-width: 160px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 8px;
  padding: 6px 0;
  z-index: 2100;
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-50);
}

.terminal-tab-menu.show {
  display: block;
}

.tab-menu-item {
  padding: 8px 14px;
  font-size: 12px;
  color: var(--kt-color-text-primary);
  cursor: pointer;
  white-space: nowrap;
}

.tab-menu-item:hover {
  background: var(--kt-color-bg-elevated);
}

.tab-menu-item.disabled {
  opacity: 0.5;
  cursor: default;
}

.tab-menu-item.disabled:hover {
  background: transparent;
}

.tab-menu-divider {
  height: 1px;
  background: var(--kt-color-border-default);
  margin: 6px 0;
}

/* アバター画像（ステータスバー用に保持） */
#avatar-image {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  image-rendering: pixelated;
}


/* xterm.js スタイル上書き */
.xterm {
  height: 100%;
  padding: 8px 12px 8px 8px;
  box-sizing: border-box;
  background: var(--kt-color-bg-canvas);
  font-family: var(--kt-type-mono-fontFamily);
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0, "calt" 0;
  font-kerning: none;
}

/* IME (composition) anchor lock: prevent candidate/preedit UI drifting during TUI redraws */
.xterm.ime-lock .composition-view.active {
  left: var(--ime-left) !important;
  top: var(--ime-top) !important;
}

.xterm.ime-lock .xterm-helper-textarea {
  left: var(--ime-left) !important;
  top: var(--ime-top) !important;
}

.xterm .xterm-viewport {
  overflow-y: auto !important;
  background-color: var(--kt-color-terminal-bg);
}

.xterm-viewport::-webkit-scrollbar {
  width: 8px;
}

.xterm-viewport::-webkit-scrollbar-track {
  background: transparent;
  margin: 4px 0;
}

.xterm-viewport::-webkit-scrollbar-thumb {
  background: var(--kt-color-alpha-white-12);
  border-radius: 4px;
  border: 2px solid transparent;
  background-clip: padding-box;
  transition: background 0.2s ease;
}

.xterm-viewport:hover::-webkit-scrollbar-thumb {
  background: var(--kt-color-alpha-white-16);
  border: 2px solid transparent;
  background-clip: padding-box;
}

.xterm-viewport::-webkit-scrollbar-thumb:hover {
  background: var(--kt-color-alpha-white-24);
  border: 2px solid transparent;
  background-clip: padding-box;
}

.xterm-viewport::-webkit-scrollbar-thumb:active {
  background: var(--kt-color-alpha-white-32);
  border: 2px solid transparent;
  background-clip: padding-box;
}

/* xterm.js カスタムスクロールバー (VS Code style) */
.xterm .xterm-scrollable-element > .scrollbar {
  background: transparent !important;
}

.xterm .xterm-scrollable-element > .scrollbar > .slider {
  background: var(--kt-color-alpha-white-08) !important;
  border-radius: 4px !important;
  width: 6px !important;
  left: 50% !important;
  transform: translateX(-50%);
}

.xterm .xterm-scrollable-element > .scrollbar:hover > .slider {
  background: var(--kt-color-alpha-white-16) !important;
}

.xterm .xterm-scrollable-element > .scrollbar > .slider:hover {
  background: var(--kt-color-alpha-white-24) !important;
}

.xterm .xterm-scrollable-element > .scrollbar > .slider:active {
  background: var(--kt-color-alpha-white-32) !important;
}

/* スクロールバーの影を非表示 */
.xterm .xterm-scrollable-element > .shadow {
  display: none !important;
}

.xterm-screen {
  height: 100%;
  background: var(--kt-color-bg-canvas);
}

/* === 設定ウィンドウ === */
.settings-panel {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: var(--kt-color-component-settings-backdrop);
  backdrop-filter: none;
  z-index: 1200;
}

.settings-panel.show {
  display: flex;
  animation: settings-fade 0.18s ease-out;
}

@keyframes settings-fade {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.settings-window {
  width: var(--settings-window-width);
  height: var(--settings-window-height);
  background: linear-gradient(180deg, var(--kt-color-component-settings-surface), var(--kt-color-component-settings-surface-strong));
  border: 1px solid var(--kt-color-component-settings-border);
  border-radius: var(--settings-window-radius);
  box-shadow: var(--kt-shadow-4);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  animation: settings-pop 0.18s ease-out;
}

@keyframes settings-pop {
  from {
    opacity: 0;
    transform: translateY(8px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.settings-window-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  background: var(--kt-color-component-settings-surface-elevated);
  border-bottom: 1px solid var(--kt-color-component-settings-border);
}

.settings-window-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--kt-color-text-primary);
}

.settings-window-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.settings-close {
  width: 28px;
  height: 28px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  font-size: 18px;
  cursor: pointer;
  border-radius: 8px;
  transition: all 0.15s;
}

.settings-close:hover {
  background: var(--kt-color-component-settings-nav-hover);
  color: var(--kt-color-text-primary);
}

.settings-window-body {
  display: grid;
  grid-template-columns: var(--settings-sidebar-width) 1fr;
  gap: var(--settings-window-gap);
  padding: 0;
  min-height: 0;
  flex: 1;
}

.settings-sidebar {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 14px;
  background: var(--kt-color-component-settings-surface-elevated);
  border-right: 1px solid var(--kt-color-component-settings-border);
}

.settings-nav-item {
  border: 1px solid transparent;
  background: transparent;
  color: var(--kt-color-text-secondary);
  padding: 10px 12px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  text-align: left;
  font-size: 13px;
  font-family: inherit;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s;
}

.settings-nav-icon {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
  stroke: currentColor;
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.settings-nav-item:hover {
  background: var(--kt-color-component-settings-nav-hover);
  color: var(--kt-color-text-primary);
}

.settings-nav-item.active {
  background: var(--kt-color-component-settings-nav-active);
  border-color: var(--kt-color-component-settings-border);
  color: var(--kt-color-text-primary);
}

.settings-content {
  overflow: auto;
  padding: var(--settings-window-padding);
  background: var(--kt-color-component-settings-surface);
  min-height: 0;
}

.settings-pane {
  display: none;
}

.settings-pane.active {
  display: block;
  animation: settings-pane 0.18s ease-out;
}

@keyframes settings-pane {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.settings-content-header {
  margin-bottom: 16px;
}

.settings-content-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--kt-color-text-primary);
}

.settings-content-subtitle {
  font-size: 12px;
  color: var(--kt-color-text-secondary);
  margin-top: 4px;
}

.settings-section-label {
  margin: 18px 0 10px;
  font-size: 11px;
  letter-spacing: 0.12em;
  color: var(--kt-color-text-secondary);
}

.settings-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  padding: 14px 4px;
  background: transparent;
  border-bottom: 1px solid var(--kt-color-component-settings-border);
  margin-bottom: 0;
  transition: background 0.15s ease;
}

.settings-row[hidden] {
  display: none !important;
}

.settings-row:hover {
  background: var(--kt-color-alpha-white-04);
}

.settings-row:last-of-type {
  border-bottom: none;
}

.settings-row-text {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.settings-row-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--kt-color-text-primary);
}

.settings-row-subtitle {
  font-size: 12px;
  color: var(--kt-color-text-secondary);
}

.settings-status {
  color: var(--kt-color-text-muted);
  white-space: pre-line;
}

.settings-status[data-tone="success"] {
  color: var(--kt-color-status-success);
}

.settings-status[data-tone="error"] {
  color: var(--kt-color-status-error);
}

.settings-status[data-tone="info"] {
  color: var(--kt-color-status-info);
}

.settings-row-control {
  min-width: 180px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 10px;
}

.settings-row-control .settings-select,
.settings-row-control .settings-input {
  width: 180px;
}

.settings-row-stack {
  flex-direction: column;
  align-items: stretch;
}

.settings-row-control-stack {
  width: 100%;
  flex-direction: column;
  align-items: stretch;
  gap: 8px;
}

.settings-row-control-stack .settings-select,
.settings-row-control-stack .settings-input {
  width: 100%;
}

.settings-ghost-button {
  border: 1px solid var(--kt-color-component-settings-border);
  background: transparent;
  color: var(--kt-color-text-primary);
  padding: 6px 10px;
  border-radius: 8px;
  font-size: 12px;
  cursor: pointer;
  transition: border-color 0.15s ease, background 0.15s ease;
}

.settings-ghost-button:hover {
  background: var(--kt-color-component-settings-nav-hover);
  border-color: var(--kt-color-component-settings-input-border);
}

.settings-shortcut-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 16px;
}

.settings-shortcut-platform {
  font-size: 11px;
  letter-spacing: 0.12em;
  color: var(--kt-color-text-secondary);
}

.settings-shortcut-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.settings-shortcut-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 16px;
  align-content: start;
}

.settings-shortcut-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid var(--kt-color-component-settings-card-border);
  background: var(--kt-color-component-settings-card-bg);
}

.settings-shortcut-group .settings-section-label {
  margin: 0 0 4px;
}

.settings-shortcut-row {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  padding: 10px 0;
  border-bottom: 1px solid var(--kt-color-component-settings-card-border);
}

.settings-shortcut-row:last-child {
  border-bottom: none;
}

.settings-shortcut-info {
  flex: 1;
  min-width: 180px;
}

.settings-shortcut-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--kt-color-text-primary);
}

.settings-shortcut-desc {
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  margin-top: 4px;
}

.settings-shortcut-keys {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
  min-width: 0;
}

.settings-shortcut-chips {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-start;
  gap: 6px;
}

.settings-shortcut-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  background: var(--kt-color-component-settings-input-bg);
  border: 1px solid var(--kt-color-component-settings-input-border);
  border-radius: 6px;
  font-size: 12px;
  color: var(--kt-color-text-primary);
}

.settings-shortcut-chip.conflict {
  border-color: var(--kt-color-component-settings-conflict-border);
  box-shadow: 0 0 0 1px var(--kt-color-component-settings-conflict-glow);
}

.settings-shortcut-chip button {
  border: none;
  background: transparent;
  color: inherit;
  font: inherit;
  cursor: pointer;
}

.settings-shortcut-edit {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
}

.settings-shortcut-edit kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 22px;
  height: 22px;
  padding: 0 6px;
  border-radius: 4px;
  border: 1px solid var(--kt-color-component-settings-border);
  background: var(--kt-color-alpha-black-35);
  font-size: 12px;
  line-height: 1;
}

.settings-shortcut-remove {
  font-size: 12px;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
}

.settings-shortcut-remove:hover {
  color: var(--kt-color-text-primary);
}

.settings-shortcut-row-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.settings-shortcut-add,
.settings-shortcut-reset {
  border: 1px solid var(--kt-color-component-settings-border);
  background: transparent;
  color: var(--kt-color-text-primary);
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 6px;
  cursor: pointer;
}

.settings-shortcut-add:hover,
.settings-shortcut-reset:hover {
  background: var(--kt-color-component-settings-nav-hover);
}

.settings-shortcut-warning {
  font-size: 11px;
  color: var(--kt-color-component-settings-conflict-text);
  text-align: left;
}

.settings-shortcut-row.recording {
  border-color: var(--kt-color-accent-primary-strong);
}

.settings-shortcut-capture {
  color: var(--kt-color-text-secondary);
  font-size: 11px;
}

.shortcut-capture-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
  z-index: 2000;
}

.shortcut-capture-overlay.show {
  opacity: 1;
  pointer-events: auto;
}

.shortcut-capture-modal {
  min-width: 320px;
  max-width: 520px;
  padding: 18px 20px;
  border-radius: 12px;
  border: 1px solid var(--kt-color-border-default);
  background: var(--kt-color-component-popover-bg);
  box-shadow: 0 16px 40px var(--kt-color-alpha-black-50);
  backdrop-filter: blur(10px);
  text-align: center;
}

.shortcut-capture-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--kt-color-text-primary);
  margin-bottom: 12px;
}

.shortcut-capture-display {
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

.shortcut-capture-display kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 28px;
  height: 28px;
  padding: 0 10px;
  border-radius: 6px;
  border: 1px solid var(--kt-color-component-settings-border);
  background: var(--kt-color-alpha-black-35);
  font-size: 13px;
  line-height: 1;
}

.shortcut-capture-placeholder {
  font-size: 13px;
  color: var(--kt-color-text-secondary);
}

.shortcut-capture-hint {
  font-size: 11px;
  color: var(--kt-color-text-secondary);
}

.settings-group {
  margin-bottom: 18px;
}

.settings-group:last-child {
  margin-bottom: 0;
}

.settings-label {
  display: block;
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  margin-bottom: 6px;
}

.settings-select {
  width: 100%;
  padding: 8px 12px;
  background: var(--kt-color-component-settings-input-bg);
  border: 1px solid var(--kt-color-component-settings-input-border);
  border-radius: 9px;
  color: var(--kt-color-text-primary);
  font-size: 13px;
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.settings-select:focus {
  outline: none;
  border-color: var(--kt-color-component-settings-accent);
  box-shadow: 0 0 0 2px var(--kt-color-accent-primary-weak);
}

.settings-input {
  width: 100%;
  padding: 8px 12px;
  background: var(--kt-color-component-settings-input-bg);
  border: 1px solid var(--kt-color-component-settings-input-border);
  border-radius: 9px;
  color: var(--kt-color-text-primary);
  font-size: 13px;
}

.settings-input.settings-input-wheel {
  cursor: var(--kt-cursor-resize-ns);
}

.settings-input:focus {
  outline: none;
  border-color: var(--kt-color-component-settings-accent);
  box-shadow: 0 0 0 2px var(--kt-color-accent-primary-weak);
}

.settings-section {
  margin: 12px 0 10px;
  padding-top: 8px;
  border-top: 1px solid var(--kt-color-border-default);
  font-size: 11px;
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
}



.settings-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.toggle-switch {
  position: relative;
  width: 42px;
  height: 22px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--kt-color-component-settings-input-bg);
  border: 1px solid var(--kt-color-component-settings-input-border);
  border-radius: 999px;
  transition: all 0.2s;
}

.toggle-slider::before {
  position: absolute;
  content: '';
  height: 16px;
  width: 16px;
  left: 2px;
  bottom: 2px;
  background: var(--kt-color-text-secondary);
  border-radius: 50%;
  transition: all 0.2s;
}

.toggle-switch input:checked + .toggle-slider {
  background: var(--kt-color-component-settings-accent);
  border-color: var(--kt-color-component-settings-accent);
}

.toggle-switch input:checked + .toggle-slider::before {
  transform: translateX(20px);
  background: white;
}

@media (max-width: 860px) {
  .settings-panel {
    padding: 16px;
  }

  .settings-window {
    width: min(96vw, 900px);
    height: min(90vh, 700px);
  }

  .settings-window-body {
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr;
  }

  .settings-sidebar {
    flex-direction: row;
    overflow-x: auto;
    border-right: none;
    border-bottom: 1px solid var(--kt-color-component-settings-border);
  }

  .settings-nav-item {
    white-space: nowrap;
  }
}

/* ========================================
   Float Actions & Toast
   ======================================== */

/* フローティングアクションコンテナ（ターミナル右下） */
.terminal-float-actions {
  position: absolute;
  bottom: 16px;
  right: 24px;
  display: flex;
  gap: 6px;
  z-index: 35;
  opacity: 0.5;
  transition: opacity 0.2s ease;
}

.terminal-float-actions:hover {
  opacity: 1;
}

.terminal-float-btn {
  position: relative;
  width: 34px;
  height: 34px;
  border: none;
  border-radius: 9px;
  background: var(--kt-color-alpha-white-06);
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  transition: background 0.15s ease, transform 0.15s ease, color 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.terminal-float-btn:hover {
  background: var(--kt-color-state-active);
  color: var(--kt-color-text-primary);
  transform: scale(1.08);
}

.terminal-float-btn:active {
  transform: scale(0.96);
}

.terminal-float-btn svg {
  width: 16px;
  height: 16px;
}

/* ピン成功時のフィードバック */
.terminal-float-btn.pinned {
  background: var(--kt-color-component-button-success-bg);
  border: 1px solid var(--kt-color-component-button-success-border);
  color: var(--kt-color-component-button-success-text);
}

/* コピー成功時のフィードバック */
.terminal-float-btn.copied {
  background: var(--kt-color-component-button-success-bg);
  color: var(--kt-color-component-button-success-text);
}

/* Loading state for float buttons */
.terminal-float-btn.loading svg {
  opacity: 0;
}

.terminal-float-btn.loading::before {
  content: '';
  position: absolute;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  border: 2px solid var(--kt-color-alpha-white-20);
  border-top-color: var(--kt-color-text-primary);
  animation: spin 0.8s linear infinite;
}

/* トースト通知 */
.terminal-toast {
  position: absolute;
  top: 16px;
  left: 16px;
  right: auto;
  bottom: auto;
  padding: 10px 16px;
  background: var(--kt-color-component-toast-neutral-bg);
  border: 1px solid var(--kt-color-component-toast-neutral-border);
  border-radius: 10px;
  color: var(--kt-color-component-toast-neutral-text);
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 0.2px;
  z-index: 60;
  opacity: 0;
  transform: translateY(8px) scale(0.96);
  pointer-events: none;
  transition: opacity 0.2s ease, transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-35);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  gap: 10px;
  max-width: 420px;
}

.terminal-toast.show {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.terminal-toast.error {
  background: var(--kt-color-status-error);
  border: 1px solid var(--kt-color-status-error);
  color: #ffffff;
  box-shadow: 0 10px 26px rgba(239, 68, 68, 0.45);
}

.terminal-toast.persistent {
  pointer-events: auto;
}

.terminal-toast-text {
  flex: 1;
  white-space: pre-line;
  line-height: 1.35;
}

.terminal-toast-close {
  appearance: none;
  border: 1px solid var(--kt-color-alpha-white-20);
  border-radius: 6px;
  background: transparent;
  color: inherit;
  font-size: 12px;
  font-weight: 600;
  padding: 2px 6px;
  line-height: 1;
  cursor: pointer;
  opacity: 0.8;
}

.terminal-toast-close:hover {
  opacity: 1;
  background: var(--kt-color-alpha-white-10);
}

.terminal-toast:not(.persistent) .terminal-toast-close {
  display: none;
}

/* フローティングボタンのツールチップ */
.terminal-float-btn::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: calc(100% + 6px);
  right: 0;
  padding: 4px 8px;
  background: var(--kt-color-component-tooltip-bg);
  border: 1px solid var(--kt-color-alpha-white-12);
  border-radius: 4px;
  color: var(--kt-color-text-secondary);
  font-size: 11px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease;
  z-index: 100;
}

.terminal-float-btn:hover::after {
  opacity: 1;
}

.terminal-session-badge {
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 2px 6px;
  border-radius: 999px;
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 0.08em;
  background: var(--kt-color-component-badge-bg);
  color: var(--kt-color-component-badge-text);
  cursor: pointer;
  transition: opacity 0.15s ease;
}

.terminal-session-badge:hover {
  opacity: 0.85;
}

.terminal-session-badge svg {
  width: 10px;
  height: 10px;
  flex-shrink: 0;
}

.terminal-session-badge.codex {
  background: var(--kt-color-component-badge-codex-bg);
  color: var(--kt-color-component-badge-codex-text);
}

.terminal-session-badge.claude {
  background: var(--kt-color-component-badge-claude-bg);
  color: var(--kt-color-component-badge-claude-text);
}

.status-debug-overlay {
  position: fixed;
  bottom: 12px;
  right: 12px;
  z-index: 9999;
  background: var(--kt-color-component-debug-bg);
  color: var(--kt-color-component-debug-text);
  font-size: 11px;
  line-height: 1.35;
  border-radius: 8px;
  padding: 8px 10px;
  min-width: 220px;
  max-width: 360px;
  box-shadow: 0 8px 20px var(--kt-color-alpha-black-35);
  backdrop-filter: blur(6px);
}

.status-debug-overlay.is-hidden {
  display: none;
}

.status-debug-title {
  font-weight: 600;
  font-size: 10px;
  letter-spacing: 0.08em;
  margin-bottom: 6px;
  opacity: 0.7;
}

.status-debug-body {
  margin: 0;
  white-space: pre-wrap;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

/* Fancy tooltip overlay (sessions + timeline) */
.fancy-tooltip-overlay {
  position: fixed;
  max-width: 420px;
  padding: 8px 10px;
  background: var(--kt-color-component-tooltip-bg-gradient);
  border: 1px solid var(--kt-color-alpha-white-16);
  border-radius: 8px;
  color: var(--kt-color-text-primary);
  font-size: calc(11px * var(--left-pane-font-scale));
  line-height: 1.4;
  opacity: 0;
  transform: none;
  pointer-events: none;
  user-select: none;
  z-index: 2000;
  box-shadow: 0 10px 30px var(--kt-color-alpha-black-50);
  backdrop-filter: blur(10px);
  transition: none;
}

.fancy-tooltip-overlay.show {
  opacity: 1;
  transform: none;
  pointer-events: auto;
  user-select: text;
}

.fancy-tooltip-overlay.pinned {
  pointer-events: auto;
  user-select: text;
  padding-right: 24px;
}

.fancy-tooltip-overlay .tooltip-close {
  position: absolute;
  top: 6px;
  right: 6px;
  width: calc(18px * var(--left-pane-font-scale));
  height: calc(18px * var(--left-pane-font-scale));
  border-radius: 4px;
  border: 1px solid var(--kt-color-alpha-white-20);
  background: var(--kt-color-component-tooltip-bg-muted);
  color: var(--kt-color-text-secondary);
  display: none;
  align-items: center;
  justify-content: center;
  font-size: calc(12px * var(--left-pane-font-scale));
  line-height: 1;
  cursor: pointer;
}

.fancy-tooltip-overlay.pinned .tooltip-close {
  display: inline-flex;
}

.fancy-tooltip-overlay .tooltip-row {
  display: flex;
  gap: 8px;
  align-items: flex-start;
  margin-bottom: 12px;
}

.fancy-tooltip-overlay .tooltip-row:last-child {
  margin-bottom: 0;
}

.fancy-tooltip-overlay .tooltip-row.tooltip-plain {
  color: var(--kt-color-text-secondary);
  font-size: calc(10px * var(--left-pane-font-scale));
}

.fancy-tooltip-overlay .tooltip-label {
  min-width: 52px;
  font-size: calc(9px * var(--left-pane-font-scale));
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
  opacity: 0.9;
  flex-shrink: 0;
}

.fancy-tooltip-overlay .tooltip-value {
  font-size: calc(11px * var(--left-pane-font-scale));
  color: var(--kt-color-text-primary);
  line-height: 1.35;
  white-space: normal;
  flex: 1 1 auto;
  min-width: 0;
}

.fancy-tooltip-overlay.pinned .tooltip-value.tooltip-value-scrollable {
  max-height: 160px;
  overflow: auto;
  padding: 6px 8px;
  border-radius: 6px;
  background: var(--kt-color-alpha-white-04);
  border: 1px solid var(--kt-color-alpha-white-12);
  white-space: pre-wrap;
  word-break: break-word;
  cursor: text;
}

.fancy-tooltip-overlay.pinned .tooltip-value-textarea {
  width: auto;
  flex: 1 1 auto;
  min-width: 0;
  min-height: 64px;
  resize: vertical;
  font-family: var(--kt-type-mono-fontFamily);
  font-size: calc(11px * var(--left-pane-font-scale));
  line-height: 1.35;
  color: var(--kt-color-text-primary);
  box-sizing: border-box;
  background: transparent;
  border: 0;
  margin: 0;
  outline: none;
}

.fancy-tooltip-overlay .tooltip-hint {
  margin: 4px -10px -8px;
  padding: 6px 10px;
  border-top: 1px solid var(--kt-color-alpha-white-08);
  color: var(--kt-color-text-secondary);
  letter-spacing: 0.08em;
  font-size: calc(8px * var(--left-pane-font-scale));
  text-align: left;
  background: var(--kt-color-alpha-white-04);
  border-radius: 0 0 8px 8px;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 6px;
}

.fancy-tooltip-overlay .tooltip-hint-key {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 1px 6px;
  margin-right: 4px;
  border-radius: 5px;
  border: 1px solid var(--kt-color-alpha-white-20);
  background: linear-gradient(180deg, var(--kt-color-alpha-white-12), var(--kt-color-alpha-white-04));
  color: var(--kt-color-text-primary);
  font-size: calc(8px * var(--left-pane-font-scale));
  letter-spacing: 0.04em;
  box-shadow: 0 1px 0 var(--kt-color-alpha-white-12);
}

.fancy-tooltip-overlay .tooltip-hint-text {
  display: inline-flex;
  align-items: center;
}

/* Pin list */
.pin-body {
  display: grid;
  grid-template-columns: minmax(140px, 0.55fr) minmax(0, 1fr) minmax(0, 1.15fr);
  gap: 12px;
  padding: 12px;
  height: 100%;
  min-height: 0;
}

.pin-projects {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 0;
  overflow: hidden;
}

.pins-filter-row {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 10px 10px 0;
  flex-shrink: 0;
}

.pins-filter-title {
  font-size: 10px;
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
  opacity: 0.7;
}

.pin-project-title {
  padding: 0 4px;
  font-size: 10px;
  letter-spacing: 0.08em;
  color: var(--kt-color-text-secondary);
}

.pin-project-list {
  display: flex;
  align-items: center;
  gap: 6px;
  overflow-x: auto;
  overflow-y: hidden;
  padding-bottom: 4px;
}

.pin-project-list::-webkit-scrollbar {
  height: 6px;
}

.pin-project-list::-webkit-scrollbar-thumb {
  background: var(--kt-color-component-session-pane-scrollbar);
  border-radius: 999px;
}

.pin-project-list::-webkit-scrollbar-track {
  background: transparent;
}

.pin-project-list::-webkit-scrollbar-thumb:hover {
  background: var(--kt-color-component-session-pane-scrollbar-hover);
}

.pin-project-item {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid transparent;
  background: var(--kt-color-component-session-pane-chip-bg);
  color: var(--kt-color-text-primary);
  font-size: 10px;
  cursor: pointer;
  transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease;
  white-space: nowrap;
}

.pin-project-item:hover {
  background: var(--kt-color-component-session-pane-hover);
  border-color: var(--kt-color-component-session-pane-border-subtle);
}

.pin-project-item.active {
  background: var(--kt-color-component-session-card-active);
  border-color: var(--kt-color-component-session-pane-border);
  color: var(--kt-color-text-primary);
}

.pin-project-label {
  flex: 1;
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.pin-project-count {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  opacity: 0.7;
}
.pin-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-height: 0;
  overflow-y: auto;
  padding: 0 8px 8px;
  flex: 1;
  --session-group-header-height: 28px;
}

.pin-list::-webkit-scrollbar {
  width: 6px;
}

.pin-list::-webkit-scrollbar-thumb {
  background: var(--kt-color-component-session-pane-scrollbar);
  border-radius: 999px;
}

.pin-list::-webkit-scrollbar-track {
  background: transparent;
}

.pin-list::-webkit-scrollbar-thumb:hover {
  background: var(--kt-color-component-session-pane-scrollbar-hover);
}

.pin-empty {
  padding: 16px 12px;
  border-radius: 0;
  border: 0;
  background: transparent;
  color: var(--kt-color-text-secondary);
  font-size: 12px;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.pin-empty svg {
  width: 32px;
  height: 32px;
  opacity: 0.4;
}

/* Search pane cards (match pin detail tone) */
.search-item {
  position: relative;
}

.search-item .session-item-header {
  padding-bottom: 0;
  position: relative;
  flex-direction: column;
  align-items: stretch;
  gap: 4px;
}

.search-item-meta {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 9px;
  color: var(--kt-color-text-secondary);
  opacity: 0.85;
}

.search-item-ago {
  margin-left: auto;
  font-size: 9px;
  color: var(--kt-color-text-primary);
  opacity: 0.78;
}

.search-item .session-item-input {
  font-size: 11px;
  font-weight: 500;
  padding: 0;
  white-space: pre-line;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.search-item-output {
  font-size: 10px;
  opacity: 0.7;
  white-space: pre-line;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.search-item .session-item-footer {
  margin-top: 0;
}

.search-item .session-item-toggle {
  min-height: 18px;
  height: 18px;
  padding: 0 8px;
}

.search-item .session-item-toggle-label {
  font-size: 9px;
  letter-spacing: 0.04em;
}

.search-item-action {
  position: absolute;
  top: 50%;
  right: 10px;
  width: 28px;
  height: 28px;
  border-radius: 8px;
  background: var(--kt-color-component-session-card-hover);
  border: 1px solid var(--kt-color-component-session-pane-border);
  color: var(--kt-color-text-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  transform: translateY(-50%);
  transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease, transform 0.15s ease;
  z-index: 2;
  box-shadow: 0 6px 14px var(--kt-color-alpha-black-35);
  opacity: 1;
}

.search-item-action:hover {
  background: var(--kt-color-component-session-card-active);
  border-color: var(--kt-color-border-default);
  color: var(--kt-color-text-primary);
  transform: translateY(-50%) scale(1.04);
}

.search-item-action.loading {
  pointer-events: none;
  background: var(--kt-color-component-session-card-active);
  border-color: var(--kt-color-component-button-ghost-hover-border);
}

.search-item-action svg {
  width: 14px;
  height: 14px;
}

.search-item-detail {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.15s ease, margin 0.15s ease, padding 0.15s ease;
  margin-left: 8px;
  border-left: 1px solid var(--kt-color-component-session-pane-divider-strong);
}

.search-item.show-detail .search-item-detail {
  max-height: none;
  margin-top: 0;
  padding-top: 4px;
  padding-bottom: 8px;
}

.search-item.show-detail .session-item-header {
  position: sticky;
  top: 0;
  z-index: 1;
  background: inherit;
  box-shadow: 0 1px 0 var(--kt-color-component-session-pane-divider);
}

.search-item-detail .search-detail-empty,
.search-item-detail .search-detail-loading {
  margin: 0 0 0 12px;
  padding: 10px 12px;
  border-radius: var(--left-pane-card-radius, 8px);
  border: 1px dashed var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  color: var(--kt-color-text-secondary);
  font-size: 11px;
}

.search-detail {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 10px 12px;
  border-radius: var(--left-pane-card-radius, 8px);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  margin: 0 0 0 12px;
}

.search-detail-label {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  letter-spacing: 0.04em;
}

.search-detail-content {
  margin: 0;
  padding: 8px;
  border-radius: 6px;
  background: var(--kt-color-bg-canvas);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  color: var(--kt-color-text-primary);
  font-family: var(--kt-type-mono-fontFamily);
  font-size: 11px;
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Pin item actions (match session cards) */
.pin-item .pin-item-action {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 22px;
  height: 22px;
  border-radius: 4px;
  background: var(--kt-color-component-session-card-bg);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  color: var(--kt-color-text-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transform: translate(0, -2px);
  transition: opacity 0.15s ease, transform 0.15s ease, background 0.15s ease, border-color 0.15s ease;
  z-index: 2;
}

.pin-item:hover .pin-item-action {
  opacity: 1;
  transform: translate(0, 0);
}

.pin-item .pin-item-action:hover {
  background: var(--kt-color-component-button-danger-bg);
  border-color: var(--kt-color-component-button-danger-border);
  color: var(--kt-color-component-button-danger-text);
}

.pin-item .pin-item-action svg {
  width: 12px;
  height: 12px;
}

.pin-item-chip {
  cursor: default;
}

.pin-item .session-item-header {
  padding-bottom: 0;
  flex-direction: column;
  align-items: stretch;
  gap: 4px;
}

.pin-item .session-item-input {
  font-size: 11px;
  font-weight: 500;
  padding: 0;
}

.pin-item .session-item-meta {
  font-size: 9px;
  gap: 6px;
  opacity: 0.8;
}

.pin-item .session-item-time {
  font-size: 9px;
}

.pin-item .session-item-output {
  font-size: 10px;
  opacity: 0.7;
}

.pin-item .session-item-toggle {
  min-height: 18px;
  height: 18px;
  padding: 0 8px;
  cursor: pointer;
}

.pin-item .session-item-toggle-label {
  font-size: 9px;
  letter-spacing: 0.04em;
}

.pin-item .session-item-footer {
  margin-top: 0;
}

.pin-item-detail {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.15s ease, margin 0.15s ease, padding 0.15s ease;
  margin-left: 8px;
  border-left: 1px solid var(--kt-color-component-session-pane-divider-strong);
}

.pin-item.show-detail .pin-item-detail {
  max-height: none;
  margin-top: 0;
  padding-top: 4px;
  padding-bottom: 8px;
}

.pin-item-detail .pin-detail-empty,
.pin-item-detail .pin-detail-loading {
  margin: 0 0 0 12px;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px dashed var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  color: var(--kt-color-text-secondary);
  font-size: 11px;
}

.pin-detail {
  display: flex;
  flex-direction: column;
  padding: 10px 12px;
  border-radius: var(--left-pane-card-radius, 10px);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  min-height: 160px;
  max-height: 45%;
  overflow: hidden;
  margin: 0 8px 10px;
  flex-shrink: 0;
}

.pin-item-detail .pin-detail {
  margin: 0 0 0 12px;
  max-height: none;
  min-height: 0;
  border-radius: var(--left-pane-card-radius, 8px);
}

.pin-detail-empty {
  padding: 24px 16px;
  border-radius: var(--left-pane-card-radius, 10px);
  border: 1px dashed var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  color: var(--kt-color-text-secondary);
  font-size: 12px;
  text-align: center;
}

.pin-detail-empty svg {
  width: 32px;
  height: 32px;
  margin-bottom: 8px;
  opacity: 0.4;
}

.pin-detail-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 6px;
  color: var(--kt-color-text-secondary);
  font-size: 11px;
  margin-bottom: 8px;
  flex-shrink: 0;
}

.pin-detail-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}

.pin-detail-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.pin-detail-btn {
  padding: 3px 8px;
  border-radius: 6px;
  background: var(--kt-color-component-button-ghost-bg);
  border: 1px solid var(--kt-color-component-button-ghost-border);
  color: var(--kt-color-text-primary);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.pin-detail-btn:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  border-color: var(--kt-color-component-button-ghost-hover-border);
}

.pin-detail-btn:active {
  transform: scale(0.95);
}

.pin-detail-btn.icon {
  padding: 5px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.pin-detail-btn.icon svg {
  display: block;
}

.pin-detail-btn.unpin {
  background: var(--kt-color-component-button-danger-bg);
  border-color: var(--kt-color-component-button-danger-border);
  color: var(--kt-color-component-button-danger-text);
}

.pin-detail-btn.unpin:hover {
  background: var(--kt-color-status-error-weak);
  border-color: var(--kt-color-status-error-glow);
}

.pin-detail-label {
  margin-bottom: 6px;
  font-size: 12px;
  color: var(--kt-color-text-primary);
  font-family: var(--kt-type-mono-fontFamily);
  flex-shrink: 0;
}

.pin-detail-content {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  margin: 0;
  padding: 10px;
  border-radius: var(--left-pane-card-radius, 8px);
  background: var(--kt-color-bg-canvas);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  color: var(--kt-color-text-primary);
  font-family: var(--kt-type-mono-fontFamily);
  font-size: 12px;
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
}

.pin-detail-content::-webkit-scrollbar {
  width: 6px;
}

.pin-detail-content::-webkit-scrollbar-thumb {
  background: var(--kt-color-text-faint);
  border-radius: 999px;
}

.pin-detail-content::-webkit-scrollbar-track {
  background: transparent;
}

.pin-detail-truncated {
  padding: 4px 8px;
  margin-bottom: 8px;
  border-radius: var(--left-pane-card-radius, 6px);
  background: var(--kt-color-component-button-warning-bg);
  border: 1px solid var(--kt-color-component-button-warning-border);
  color: var(--kt-color-component-button-warning-text);
  font-size: 10px;
  flex-shrink: 0;
}

/* Pins in left pane */
.left-pane-pins {
  background: var(--kt-color-component-session-pane-bg);
}

.left-pane-active .session-section-empty {
  margin-top: 8px;
}

.pins-sidebar-header {
  border-bottom: 1px solid var(--kt-color-component-session-pane-border);
}

.pins-sidebar-body {
  flex: 1;
  min-height: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

@media (max-width: 820px) {
  .pin-body {
    grid-template-columns: 1fr;
  }
  .pin-detail {
    min-height: 220px;
  }
}

/* ピンコンテンツ（ANSIカラー対応） */
.terminal-pin-content {
  font-family: var(--kt-type-mono-fontFamily);
  font-size: 12px;
  line-height: 1.4;
  white-space: pre-wrap;
  word-break: break-all;
  background: var(--kt-color-bg-canvas);
  border-radius: 6px;
  padding: 12px;
  height: 100%;
  overflow-y: auto;
}

.terminal-pin-loading {
  font-size: 12px;
  color: var(--kt-color-text-secondary);
}

.terminal-pin-truncated {
  margin-bottom: 8px;
  padding: 6px 8px;
  border-radius: 6px;
  background: var(--kt-color-component-button-warning-bg);
  border: 1px solid var(--kt-color-component-button-warning-border);
  color: var(--kt-color-component-button-warning-text);
  font-size: 11px;
}

/* ANSI カラー */
.terminal-pin-content .ansi-black { color: var(--kt-color-terminal-ansi-black); }
.terminal-pin-content .ansi-red { color: var(--kt-color-terminal-ansi-red); }
.terminal-pin-content .ansi-green { color: var(--kt-color-terminal-ansi-green); }
.terminal-pin-content .ansi-yellow { color: var(--kt-color-terminal-ansi-yellow); }
.terminal-pin-content .ansi-blue { color: var(--kt-color-terminal-ansi-blue); }
.terminal-pin-content .ansi-magenta { color: var(--kt-color-terminal-ansi-magenta); }
.terminal-pin-content .ansi-cyan { color: var(--kt-color-terminal-ansi-cyan); }
.terminal-pin-content .ansi-white { color: var(--kt-color-terminal-ansi-white); }
.terminal-pin-content .ansi-bright-black { color: var(--kt-color-terminal-ansi-bright-black); }
.terminal-pin-content .ansi-bright-red { color: var(--kt-color-terminal-ansi-bright-red); }
.terminal-pin-content .ansi-bright-green { color: var(--kt-color-terminal-ansi-bright-green); }
.terminal-pin-content .ansi-bright-yellow { color: var(--kt-color-terminal-ansi-bright-yellow); }
.terminal-pin-content .ansi-bright-blue { color: var(--kt-color-terminal-ansi-bright-blue); }
.terminal-pin-content .ansi-bright-magenta { color: var(--kt-color-terminal-ansi-bright-magenta); }
.terminal-pin-content .ansi-bright-cyan { color: var(--kt-color-terminal-ansi-bright-cyan); }
.terminal-pin-content .ansi-bright-white { color: var(--kt-color-terminal-ansi-bright-white); }
.terminal-pin-content .ansi-bold { font-weight: bold; }
.terminal-pin-content .ansi-dim { opacity: 0.7; }
.terminal-pin-content .ansi-italic { font-style: italic; }
.terminal-pin-content .ansi-underline { text-decoration: underline; }

/* ピンが空の時のメッセージ */
.terminal-pin-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--kt-color-text-secondary);
  font-size: 12px;
  text-align: center;
  gap: 8px;
}

.terminal-pin-empty svg {
  width: 32px;
  height: 32px;
  opacity: 0.4;
}

/* ========================================
   Image Preview Tooltip
   ======================================== */

.image-preview-tooltip {
  position: fixed;
  z-index: 3000;
  width: 520px;
  max-width: calc(100vw - 24px);
  max-height: calc(100vh - 24px);
  background: var(--kt-color-component-preview-bg);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 12px;
  box-shadow: 0 12px 40px var(--kt-color-alpha-black-50);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  opacity: 0;
  transform: scale(0.95) translateY(4px);
  pointer-events: none;
  transition: opacity 0.15s ease, transform 0.15s ease;
}

.image-preview-tooltip.show {
  opacity: 1;
  transform: scale(1) translateY(0);
  pointer-events: auto;
}

.image-preview-img {
  display: block;
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;
  background: var(--kt-color-component-pattern-checker);
}

.image-preview-content {
  display: none;
  flex: 1;
  min-height: 0;
  padding: 8px;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  background: var(--kt-color-component-pattern-checker);
}

.image-preview-loading,
.image-preview-error {
  display: none;
  padding: 32px 16px;
  text-align: center;
  font-size: 12px;
  color: var(--kt-color-text-secondary);
}

.image-preview-tooltip.loading .image-preview-loading {
  display: block;
}

.image-preview-tooltip.error .image-preview-error {
  display: block;
  color: var(--kt-color-component-button-danger-text);
}

.image-preview-tooltip.show .image-preview-content {
  display: flex;
}

.image-preview-tooltip.loading .image-preview-content,
.image-preview-tooltip.error .image-preview-content {
  display: none;
}

/* ========================================
   Markdown Preview Tooltip
   ======================================== */

.md-preview-tooltip {
  position: fixed;
  z-index: 2500;
  width: 520px;
  max-width: calc(100vw - 24px);
  max-height: calc(100vh - 24px);
  background: var(--kt-color-component-preview-bg);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 12px;
  box-shadow: 0 12px 40px var(--kt-color-alpha-black-50);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  opacity: 0;
  transform: translateY(4px) scale(0.98);
  pointer-events: none;
  transition: opacity 0.15s ease, transform 0.15s ease;
}

.md-preview-tooltip.show {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

.md-preview-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  border-bottom: 1px solid var(--kt-color-border-default);
  background: var(--kt-color-component-preview-header-bg);
  flex-shrink: 0;
  cursor: move;
}

.md-preview-info {
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.md-preview-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
  cursor: default;
}

.md-preview-hint {
  font-size: 10px;
  color: var(--kt-color-text-faint);
  flex-shrink: 0;
}

.md-preview-close {
  width: 24px;
  height: 24px;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
  font-size: 12px;
}

.md-preview-close:hover {
  background: var(--kt-color-bg-elevated);
  color: var(--kt-color-text-primary);
}

.md-preview-loading {
  display: none;
  padding: 40px 20px;
  text-align: center;
  color: var(--kt-color-text-secondary);
  font-size: 12px;
}

.md-preview-error {
  display: none;
  padding: 40px 20px;
  text-align: center;
  color: var(--kt-color-component-button-danger-text);
  font-size: 12px;
}

.md-preview-content {
  display: none;
  flex: 1;
  min-height: 0;
  padding: 16px;
  overflow-y: auto;
}

.md-preview-tooltip.loading .md-preview-loading {
  display: block;
}

.md-preview-tooltip.error .md-preview-error {
  display: block;
}

.md-preview-tooltip.loading .md-preview-hint,
.md-preview-tooltip.error .md-preview-hint {
  display: none;
}

.md-preview-resize-handle {
  position: absolute;
  z-index: 2;
  background: transparent;
}

.md-preview-resize-handle.n,
.md-preview-resize-handle.s {
  left: 8px;
  right: 8px;
  height: 6px;
}

.md-preview-resize-handle.e,
.md-preview-resize-handle.w {
  top: 8px;
  bottom: 8px;
  width: 6px;
}

.md-preview-resize-handle.n { top: 0; cursor: ns-resize; }
.md-preview-resize-handle.s { bottom: 0; cursor: ns-resize; }
.md-preview-resize-handle.e { right: 0; cursor: ew-resize; }
.md-preview-resize-handle.w { left: 0; cursor: ew-resize; }

.md-preview-resize-handle.ne,
.md-preview-resize-handle.nw,
.md-preview-resize-handle.se,
.md-preview-resize-handle.sw {
  width: 8px;
  height: 8px;
}

.md-preview-resize-handle.ne { top: 0; right: 0; cursor: nesw-resize; }
.md-preview-resize-handle.nw { top: 0; left: 0; cursor: nwse-resize; }
.md-preview-resize-handle.se { bottom: 0; right: 0; cursor: nwse-resize; }
.md-preview-resize-handle.sw { bottom: 0; left: 0; cursor: nesw-resize; }

/* GitHub-style Markdown body */
.markdown-body {
  color: var(--kt-color-component-markdown-text);
  font-family: var(--kt-type-ui-fontFamily);
  font-size: 13px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 20px;
  margin-bottom: 12px;
  font-weight: 600;
  line-height: 1.25;
  color: var(--kt-color-component-markdown-heading);
}

.markdown-body h1 {
  font-size: 1.75em;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--kt-color-border-default);
}

.markdown-body h2 {
  font-size: 1.4em;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--kt-color-border-default);
}

.markdown-body h3 { font-size: 1.2em; }
.markdown-body h4 { font-size: 1.05em; }
.markdown-body h5 { font-size: 0.95em; }
.markdown-body h6 { font-size: 0.9em; color: var(--kt-color-text-secondary); }

.markdown-body p {
  margin-top: 0;
  margin-bottom: 12px;
}

.markdown-body a {
  color: var(--kt-color-component-markdown-link);
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
  color: var(--kt-color-component-markdown-heading);
}

.markdown-body em {
  font-style: italic;
}

.markdown-body code {
  padding: 2px 6px;
  margin: 0 2px;
  font-size: 0.9em;
  font-family: var(--kt-type-mono-fontFamily);
  background: var(--kt-color-component-markdown-code-bg);
  border-radius: 6px;
}

.markdown-body pre {
  margin: 12px 0;
  padding: 12px;
  overflow-x: auto;
  font-size: 12px;
  line-height: 1.45;
  background: var(--kt-color-component-markdown-pre-bg);
  border-radius: 8px;
  border: 1px solid var(--kt-color-border-default);
}

.markdown-body pre code {
  display: block;
  padding: 0;
  margin: 0;
  font-size: inherit;
  background: transparent;
  border-radius: 0;
  white-space: pre;
  overflow-x: auto;
}

.markdown-body blockquote {
  margin: 12px 0;
  padding: 0 16px;
  color: var(--kt-color-text-secondary);
  border-left: 4px solid var(--kt-color-component-markdown-quote-border);
}

.markdown-body ul,
.markdown-body ol {
  margin-top: 0;
  margin-bottom: 12px;
  padding-left: 24px;
}

.markdown-body li {
  margin-bottom: 4px;
}

.markdown-body li + li {
  margin-top: 4px;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ul,
.markdown-body ol ol {
  margin-top: 4px;
  margin-bottom: 0;
}

.markdown-body hr {
  height: 1px;
  margin: 20px 0;
  background: var(--kt-color-border-default);
  border: 0;
}

.markdown-body table {
  width: 100%;
  margin: 12px 0;
  border-spacing: 0;
  border-collapse: collapse;
}

.markdown-body table th,
.markdown-body table td {
  padding: 8px 12px;
  border: 1px solid var(--kt-color-border-default);
}

.markdown-body table th {
  font-weight: 600;
  background: var(--kt-color-component-markdown-table-bg);
}

.markdown-body table tr:nth-child(2n) {
  background: var(--kt-color-component-markdown-table-alt);
}

.markdown-body img {
  max-width: 100%;
  height: auto;
  border-radius: 6px;
}

/* Task list */
.markdown-body input[type="checkbox"] {
  margin-right: 6px;
  vertical-align: middle;
}

/* Highlight.js theme (GitHub Dark) */
.hljs {
  color: var(--kt-color-syntax-text);
}

.hljs-comment,
.hljs-quote {
  color: var(--kt-color-syntax-comment);
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal {
  color: var(--kt-color-syntax-keyword);
}

.hljs-name,
.hljs-tag {
  color: var(--kt-color-syntax-tag);
}

.hljs-attr,
.hljs-attribute,
.hljs-variable,
.hljs-template-variable {
  color: var(--kt-color-syntax-attr);
}

.hljs-string,
.hljs-doctag {
  color: var(--kt-color-syntax-string);
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: var(--kt-color-syntax-title);
  font-weight: 600;
}

.hljs-type,
.hljs-class .hljs-title {
  color: var(--kt-color-syntax-type);
}

.hljs-symbol,
.hljs-bullet,
.hljs-link {
  color: var(--kt-color-syntax-number);
}

.hljs-number {
  color: var(--kt-color-syntax-number);
}

.hljs-built_in,
.hljs-builtin-name {
  color: var(--kt-color-syntax-type);
}

.hljs-meta {
  color: var(--kt-color-syntax-meta);
}

.hljs-deletion {
  color: var(--kt-color-syntax-deletion);
  background: var(--kt-color-syntax-deletion-bg);
}

.hljs-addition {
  color: var(--kt-color-syntax-addition);
  background: var(--kt-color-syntax-addition-bg);
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: 600;
}

/* ========================================
   Link Hint Tooltip
   ======================================== */

.terminal-link-hint {
  position: fixed;
  z-index: 3000;
  padding: 6px 10px;
  background: var(--kt-color-component-popover-bg);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 8px;
  color: var(--kt-color-text-secondary);
  font-size: 11px;
  opacity: 0;
  transform: translateY(2px);
  pointer-events: none;
  transition: opacity 0.12s ease, transform 0.12s ease;
  box-shadow: 0 6px 18px var(--kt-color-alpha-black-35);
  white-space: nowrap;
}

.terminal-link-hint.show {
  opacity: 1;
  transform: translateY(0);
}

/* ========================================
   TUI IME Composition Bar
   ======================================== */

/* TUIモード時のIME入力バー（ターミナルパネル下部） */
.xterm-helper-textarea.tui-composition-bar {
  position: fixed !important;
  bottom: var(--tui-bar-bottom, 0) !important;
  left: var(--tui-bar-left, 0) !important;
  top: auto !important;
  width: var(--tui-bar-width, 100%) !important;
  height: 44px !important;
  opacity: 1 !important;
  background: var(--kt-color-bg-elevated) !important;
  color: var(--kt-color-text-primary) !important;
  font-size: 16px !important;
  font-family: var(--kt-type-mono-fontFamily) !important;
  padding: 10px 16px !important;
  border: none !important;
  border-top: 2px solid var(--kt-color-border-default) !important;
  border-radius: 0 !important;
  z-index: 10000 !important;
  outline: none !important;
  box-shadow: 0 -4px 20px var(--kt-color-alpha-black-50) !important;
  caret-color: var(--kt-color-text-primary) !important;
}

/* ショートカットチートシート */
.shortcut-sheet {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--kt-color-alpha-black-65);
  backdrop-filter: blur(8px);
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.15s ease, visibility 0.15s ease;
}

.shortcut-sheet.show {
  opacity: 1;
  visibility: visible;
}

.shortcut-sheet-content {
  display: flex;
  gap: 32px;
  padding: 28px 36px;
  background: var(--kt-color-bg-surface);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 12px;
  box-shadow: 0 16px 48px var(--kt-color-alpha-black-50);
}

.shortcut-section {
  min-width: 180px;
}

.shortcut-section-title {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1.2px;
  color: var(--kt-color-text-secondary);
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--kt-color-border-default);
}

.shortcut-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  padding: 6px 0;
}

.shortcut-keys {
  display: flex;
  gap: 4px;
}

.shortcut-keys kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 22px;
  padding: 0 6px;
  font-family: inherit;
  font-size: 11px;
  font-weight: 500;
  color: var(--kt-color-text-primary);
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 4px;
}

.shortcut-desc {
  font-size: 12px;
  color: var(--kt-color-text-secondary);
}

.shortcut-hint {
  position: absolute;
  bottom: -32px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  opacity: 0.6;
}

/* ========== Pane Drag & Drop ========== */

/* Drag ghost */
.pane-drag-ghost {
  position: fixed;
  z-index: 10000;
  padding: 6px 12px;
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-accent-primary);
  border-radius: 6px;
  color: var(--kt-color-text-primary);
  font-size: 12px;
  font-family: var(--kt-type-mono-fontFamily);
  pointer-events: none;
  box-shadow: 0 4px 16px var(--kt-color-alpha-black-50);
  white-space: nowrap;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Dragging state */
body.pane-dragging {
  cursor: grabbing !important;
  user-select: none;
}

body.pane-dragging * {
  cursor: grabbing !important;
}

.terminal-pane.drag-source {
  opacity: 0.5;
}

/* Swap hint overlay (full pane highlight) */
.pane-swap-hint-overlay {
  position: absolute;
  inset: 0;
  z-index: 100;
  pointer-events: none;
  background: var(--kt-color-component-drag-hint-bg);
  border: 2px solid var(--kt-color-accent-primary);
  border-radius: 4px;
}

/* Header draggable cursor */
.terminal-pane-header {
  cursor: grab;
}

.terminal-pane-header:active {
  cursor: grabbing;
}

/* Pane header when only 1 pane (not draggable) */
.terminal-pane:only-child .terminal-pane-header {
  cursor: default;
}

/* Tabs bar as drop target for pane */
.tabs-bar.pane-drop-target {
  background: var(--kt-color-component-drag-hint-bg);
  border-bottom: 2px solid var(--kt-color-accent-primary);
}

/* Ghost detach hint (when dragging outside window) */
.pane-drag-ghost.detach-hint::after {
  content: ' → New Window';
  color: var(--kt-color-accent-primary);
  font-size: 10px;
  margin-left: 6px;
}

/* ===== Session Recovery Modal ===== */
.recovery-modal-overlay {
  position: fixed;
  inset: 0;
  background: var(--kt-color-alpha-black-65);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.recovery-modal-overlay.visible {
  display: flex;
}

.recovery-modal {
  background: var(--kt-color-bg-elevated);
  border: 1px solid var(--kt-color-border-default);
  border-radius: 8px;
  width: 240px;
  padding: 16px;
}

.recovery-modal-header {
  font-size: 13px;
  font-weight: 500;
  color: var(--kt-color-text-primary);
  margin-bottom: 4px;
}

.recovery-modal-meta {
  font-size: 11px;
  color: var(--kt-color-text-faint);
  margin-bottom: 16px;
}

.recovery-modal-actions {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.recovery-btn {
  width: 100%;
  padding: 8px 12px;
  border: none;
  border-radius: 4px;
  background: var(--kt-color-state-hover);
  color: var(--kt-color-text-primary);
  font-size: 12px;
  text-align: left;
  cursor: pointer;
}

.recovery-btn:hover {
  background: var(--kt-color-state-active);
}

.recovery-btn-secondary {
  background: transparent;
  color: var(--kt-color-text-secondary);
}

.recovery-btn-secondary:hover {
  background: var(--kt-color-state-hover);
  color: var(--kt-color-text-primary);
}

/* ===== Onboarding Overlay ===== */
.onboarding-panel {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: var(--kt-color-component-onboarding-scrim);
  backdrop-filter: blur(20px);
  z-index: 1300;
}

.onboarding-panel.show {
  display: flex;
  animation: onboarding-fade 0.25s ease-out;
}

@keyframes onboarding-fade {
  from { opacity: 0; }
  to { opacity: 1; }
}

.onboarding-window {
  width: min(400px, 90vw);
  background: var(--kt-color-component-onboarding-window-bg);
  border-radius: 12px;
  padding: 28px 32px 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.onboarding-content {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.onboarding-result {
  width: 100%;
  display: none;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 12px 0 4px;
}

.onboarding-window.is-result .onboarding-content {
  display: none;
}

.onboarding-window.is-result .onboarding-result {
  display: flex;
}

.onboarding-result-icon {
  width: 72px;
  height: 72px;
  display: none;
}

.onboarding-result-icon svg {
  width: 72px;
  height: 72px;
}

.onboarding-result-icon.success {
  color: var(--kt-color-component-onboarding-status-success);
}

.onboarding-result-icon.error {
  color: var(--kt-color-component-onboarding-status-error);
}

.onboarding-window[data-result="success"] .onboarding-result-icon.success {
  display: block;
}

.onboarding-window[data-result="error"] .onboarding-result-icon.error {
  display: block;
}

.onboarding-result-ring,
.onboarding-result-check,
.onboarding-result-x {
  fill: none;
  stroke: currentColor;
  stroke-width: 4;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.onboarding-window.is-result .onboarding-result-ring {
  stroke-dasharray: 164;
  stroke-dashoffset: 164;
  animation: onboarding-ring 0.6s ease-out forwards;
}

.onboarding-window.is-result[data-result="success"] .onboarding-result-check {
  stroke-dasharray: 60;
  stroke-dashoffset: 60;
  animation: onboarding-check 0.35s ease-out 0.4s forwards;
}

.onboarding-window.is-result[data-result="error"] .onboarding-result-x {
  stroke-dasharray: 40;
  stroke-dashoffset: 40;
  animation: onboarding-x 0.3s ease-out 0.4s forwards;
}

.onboarding-result-text {
  font-size: 12px;
  line-height: 1.5;
  text-align: center;
  color: var(--kt-color-component-onboarding-text-muted);
  max-width: 320px;
}

.onboarding-result-text:empty {
  display: none;
}

@keyframes onboarding-ring {
  to { stroke-dashoffset: 0; }
}

@keyframes onboarding-check {
  to { stroke-dashoffset: 0; }
}

@keyframes onboarding-x {
  to { stroke-dashoffset: 0; }
}

.onboarding-icon {
  margin-bottom: 16px;
  color: var(--kt-color-component-onboarding-text);
}


.onboarding-tagline {
  display: block;
  white-space: nowrap;
  margin-top: 8px;
  text-align: center;
  width: 100%;
}

.ultrathink {
  font-weight: 600;
  background: var(--kt-color-component-onboarding-gradient);
  background-size: 200% 100%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: ultrathink-flow 3s linear infinite;
}

@keyframes ultrathink-flow {
  from { background-position: 0% 50%; }
  to { background-position: 200% 50%; }
}

.onboarding-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--kt-color-component-onboarding-text);
  letter-spacing: -0.01em;
  margin-bottom: 12px;
}

.onboarding-desc {
  font-size: 13px;
  color: var(--kt-color-component-onboarding-text-muted);
  line-height: 1.55;
  margin-bottom: 18px;
  max-width: 320px;
  text-align: left;
}

.onboarding-options {
  width: auto;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  box-sizing: border-box;
}

.onboarding-checkbox {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  color: var(--kt-color-component-onboarding-text-muted);
  font-size: 10px;
  opacity: 0.65;
}

.onboarding-checkbox input[type="checkbox"] {
  width: 11px;
  height: 11px;
  accent-color: var(--kt-color-component-onboarding-status-success);
}

.onboarding-checkbox-label {
  line-height: 1.2;
}

.onboarding-status-line {
  font-size: 13px;
  min-height: 20px;
  margin-bottom: 8px;
}

.onboarding-status-line:empty {
  display: none;
}

.onboarding-status-line[data-tone="success"] {
  color: var(--kt-color-component-onboarding-status-success);
}

.onboarding-status-line[data-tone="error"] {
  color: var(--kt-color-component-onboarding-status-error);
}

.onboarding-status-line[data-tone="info"] {
  color: var(--kt-color-component-onboarding-status-info);
}

.onboarding-footer {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 16px;
  border-top: 1px solid var(--kt-color-component-onboarding-border);
  margin-top: auto;
  gap: 16px;
}

.onboarding-dismiss-link {
  background: none;
  border: none;
  padding: 0;
  font-size: 11px;
  color: var(--kt-color-component-onboarding-text-muted);
  opacity: 0.7;
  cursor: pointer;
  text-align: left;
}

.onboarding-dismiss-link:hover {
  opacity: 0.95;
}

.onboarding-footer-left {
  display: flex;
  align-items: center;
}

.onboarding-footer-stack {
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
  text-align: left;
}

.onboarding-footer-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.onboarding-button {
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.15s ease;
}

.onboarding-button.secondary {
  background: transparent;
  color: var(--kt-color-text-secondary);
  padding: 8px 16px 8px 0;
  text-align: left;
}

.onboarding-button.secondary:hover {
  color: var(--kt-color-component-onboarding-button-secondary-hover);
}

.onboarding-button.primary {
  background: var(--kt-color-component-onboarding-button-primary-bg);
  color: var(--kt-color-accent-on-primary);
  border: 1px solid var(--kt-color-component-onboarding-button-primary-border);
}

.onboarding-button.primary:hover {
  background: var(--kt-color-component-onboarding-button-primary-hover);
}

.onboarding-button:active {
  transform: scale(0.97);
}

.onboarding-button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.onboarding-hidden {
  display: none;
}


/* ========================================
   Session Pane UX Improvements (Override)
   ======================================== */

.session-group-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  padding-left: 8px;
  background: var(--kt-color-component-session-card-bg);
  border: none;
  border-radius: var(--left-pane-card-radius, 2px);
  cursor: pointer;
  transition: none;
  user-select: none;
  font-weight: 600;
  margin: 0;
  color: var(--kt-color-text-secondary);
  position: sticky;
  top: 0;
  z-index: 3;
  box-shadow: 0 1px 0 var(--kt-color-component-session-pane-border-subtle);
  min-height: var(--session-group-header-height);
}

.session-group-git-actions {
  margin-left: auto;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  position: relative;
}

.session-group-git-actions.is-hidden {
  display: none;
}

.session-group-git-main {
  width: 24px;
  height: 24px;
  padding: 0;
  border-radius: 6px;
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-card-bg);
  color: var(--kt-color-text-secondary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.session-group-git-main svg {
  width: 14px;
  height: 14px;
}

.session-group-git-main:hover {
  background: var(--kt-color-component-session-card-hover);
  color: var(--kt-color-text-primary);
}

.session-group-git-main:active {
  background: var(--kt-color-component-session-card-active);
}

.session-group-git-panel {
  margin: 6px 8px 0;
  padding: 10px;
  border-radius: var(--left-pane-card-radius, 8px);
  background: var(--kt-color-component-session-card-bg);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.git-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 11px;
  color: var(--kt-color-text-secondary);
  letter-spacing: 0.04em;
}

.git-panel-close {
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  font-size: 14px;
  line-height: 1;
  padding: 0 4px;
}

.git-panel-close:hover {
  color: var(--kt-color-text-primary);
}

.git-commit-row {
  display: flex;
  align-items: center;
  gap: 6px;
}

.git-commit-input {
  flex: 1;
  min-width: 0;
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  background: var(--kt-color-component-session-pane-bg-muted);
  color: var(--kt-color-text-primary);
  border-radius: 8px;
  padding: 6px 8px;
  font-size: 12px;
  outline: none;
  line-height: 1.4;
  min-height: 42px;
  resize: vertical;
}

.git-commit-input::placeholder {
  color: var(--kt-color-text-secondary);
  opacity: 0.7;
}

.git-commit-ai {
  width: 28px;
  height: 28px;
  padding: 0;
  border-radius: 8px;
  border: 1px solid var(--kt-color-component-button-ghost-border);
  background: var(--kt-color-component-button-ghost-bg);
  color: var(--kt-color-text-secondary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  position: relative;
}

.git-commit-ai svg {
  width: 16px;
  height: 16px;
}

.git-commit-ai.is-loading svg {
  opacity: 0.35;
}

.git-commit-ai-spinner {
  position: absolute;
  width: 14px;
  height: 14px;
  border-radius: 999px;
  border: 2px solid var(--kt-color-component-session-pane-border-subtle);
  border-top-color: var(--kt-color-text-primary);
  opacity: 0;
  animation: git-commit-spin 0.9s linear infinite;
}

.git-commit-ai.is-loading .git-commit-ai-spinner {
  opacity: 1;
}

@keyframes git-commit-spin {
  to {
    transform: rotate(360deg);
  }
}

.git-commit-ai:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  border-color: var(--kt-color-component-button-ghost-hover-border);
  color: var(--kt-color-text-primary);
}

.git-commit-ai:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.git-panel-actions {
  display: flex;
  justify-content: flex-end;
}

.git-panel-action-group {
  position: relative;
  display: inline-flex;
  align-items: stretch;
}

.git-panel-action {
  border: 1px solid var(--kt-color-component-button-ghost-border);
  background: var(--kt-color-component-button-ghost-bg);
  color: var(--kt-color-text-primary);
  border-radius: 8px 0 0 8px;
  padding: 6px 12px;
  font-size: 12px;
  cursor: pointer;
}

.git-panel-action:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  border-color: var(--kt-color-component-button-ghost-hover-border);
}

.git-panel-action:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.git-panel-action-menu {
  width: 28px;
  border: 1px solid var(--kt-color-component-button-ghost-border);
  border-left: none;
  background: var(--kt-color-component-button-ghost-bg);
  color: var(--kt-color-text-secondary);
  border-radius: 0 8px 8px 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.git-panel-action-menu svg {
  width: 12px;
  height: 12px;
}

.git-panel-action-menu:hover {
  background: var(--kt-color-component-button-ghost-hover-bg);
  border-color: var(--kt-color-component-button-ghost-hover-border);
  color: var(--kt-color-text-primary);
}

.git-panel-action-menu:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.git-panel-action-menu-list {
  position: absolute;
  right: 0;
  top: calc(100% + 6px);
  min-width: 150px;
  padding: 6px;
  display: none;
  flex-direction: column;
  gap: 2px;
  background: var(--kt-color-component-session-pane-bg-strong);
  border: 1px solid var(--kt-color-component-session-pane-border-subtle);
  border-radius: 8px;
  box-shadow: 0 12px 24px var(--kt-color-alpha-black-50);
  z-index: 20;
}

.git-panel-action-menu-list.show {
  display: flex;
}

.git-panel-action-menu-item {
  border: none;
  background: transparent;
  color: var(--kt-color-text-primary);
  font-size: 12px;
  text-align: left;
  padding: 6px 8px;
  border-radius: 6px;
  cursor: pointer;
}

.git-panel-action-menu-item:hover {
  background: var(--kt-color-component-session-card-hover);
}

.git-panel-result {
  display: flex;
  align-items: center;
  gap: 8px;
  padding-top: 6px;
  font-size: 11px;
  color: var(--kt-color-text-secondary);
}

.git-panel-result.success {
  color: var(--kt-color-text-primary);
}

.git-panel-result.error {
  color: var(--kt-color-status-error);
}

.git-panel-result-message {
  font-weight: 500;
  font-size: 12px;
}

.git-panel-result-details {
  margin-top: 6px;
  color: var(--kt-color-text-secondary);
}

.git-panel-result-details summary {
  cursor: pointer;
}

.git-panel-result-details pre {
  margin-top: 6px;
  font-family: var(--kt-type-mono-fontFamily);
  font-size: 10px;
  line-height: 1.4;
  white-space: pre-wrap;
  color: var(--kt-color-text-secondary);
}

.session-group-header:hover {
  background: var(--kt-color-component-session-card-hover);
  color: var(--kt-color-text-primary);
  opacity: 1;
}

.session-group-header:active {
  background: var(--kt-color-component-session-card-active);
  opacity: 1;
}

.session-item {
  position: relative;
  margin: 0;
  background: transparent;
  border: none;
  border-radius: 0;
  cursor: pointer;
  transition: none;
  display: flex;
  flex-direction: column;
  gap: 0;
  padding: 6px 8px;
  border-bottom: 1px solid var(--kt-color-border-subtle);
}

.session-item.is-resume-glint::after {
  content: '';
  position: absolute;
  inset: 2px -60% 2px -60%;
  border-radius: 6px;
  background: linear-gradient(110deg, transparent 0%, var(--kt-color-alpha-white-32) 42%, transparent 70%);
  pointer-events: none;
  opacity: 0;
  will-change: transform, opacity;
  animation: session-glint 0.35s ease-out 0s 1 both;
}


.session-item-header {
  position: relative;
  padding: 0;
  background: transparent;
  border: none;
  border-radius: inherit;
  transition: none;
  display: flex;
  flex-direction: row;
  gap: 0;
  align-items: center;
  justify-content: flex-start;
  margin-bottom: 0;
}


/* 左側のchevron (タイムライン展開用) */
.session-item-expander {
  width: 22px;
  height: 22px;
  padding: 0;
  margin-right: 6px;
  margin-left: 0;
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--kt-color-alpha-white-04);
  background: var(--kt-color-alpha-white-04);
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  border-radius: 3px;
  transition: none;
}

.session-item-expander:hover {
  color: var(--kt-color-text-primary);
  background: var(--kt-color-alpha-white-06);
  border-color: var(--kt-color-alpha-white-12);
}

.session-item-expander:focus-visible {
  outline: 2px solid var(--kt-color-state-focus-ring);
  outline-offset: 1px;
}

.session-item-expander svg {
  width: 12px;
  height: 12px;
  transition: none;
}

.session-item.show-timeline .session-item-expander svg {
  transform: rotate(90deg);
}

.session-status-dot {
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: transparent;
  opacity: 0;
  margin: 0 6px 0 2px;
  flex-shrink: 0;
  position: relative;
  transition: none;
  pointer-events: none;
  transform-origin: center;
}

.session-section-history .session-status-dot {
  display: none;
}

/* Recover space for message text in history rows without shrinking click target */
.session-section-history .session-item-expander {
  margin-right: 6px;
}

.session-status-dot.is-visible {
  opacity: 1;
}

@keyframes status-complete-pop {
  0% { transform: scale(1); }
  45% { transform: scale(1.6); box-shadow: 0 0 8px var(--kt-color-status-success-glow); }
  100% { transform: scale(1); box-shadow: none; }
}

.session-status-dot.is-complete-pop {
  animation: none;
}

@media (prefers-reduced-motion: reduce) {
  .session-status-dot.is-complete-pop {
    animation: none;
  }
}

.session-status-dot.status-working {
  background: var(--kt-color-status-info);
  box-shadow: 0 0 6px var(--kt-color-status-info-glow);
  animation: status-pulse 1.2s ease-in-out infinite;
}

.session-status-dot.status-waiting_user {
  background: transparent;
  box-shadow: none;
  color: var(--kt-color-status-warning);
  --status-icon: var(--kt-icon-status-question);
}

.session-status-dot.status-completed {
  background: transparent;
  box-shadow: none;
  color: var(--kt-color-status-success-weak);
  --status-icon: var(--kt-icon-status-check-read);
  --status-icon-scale: 110%;
}

.session-status-dot.status-completed.is-unread {
  color: var(--kt-color-status-success);
  --status-icon: var(--kt-icon-status-check-unread);
  --status-icon-scale: 120%;
}

.session-status-dot.status-waiting_user::after,
.session-status-dot.status-completed::after {
  content: '';
  position: absolute;
  inset: -2px;
  background: currentColor;
  -webkit-mask-image: var(--status-icon);
  mask-image: var(--status-icon);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-size: var(--status-icon-scale, 120%) var(--status-icon-scale, 120%);
  mask-size: var(--status-icon-scale, 120%) var(--status-icon-scale, 120%);
}

.session-status-dot.status-stalled {
  background: var(--kt-color-status-warning);
  box-shadow: 0 0 6px var(--kt-color-status-warning-glow);
}

.session-status-dot.status-stopped {
  background: var(--kt-color-alpha-white-32);
}

/* メインコンテンツ (クリックでresume) */
.session-item-content {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
  padding: 2px 0;
  border-radius: 4px;
  cursor: pointer;
  transition: none;
}

.session-item-content:hover {
  background: transparent;
}

.session-item-content:active {
  background: transparent;
}

/* 時間表示 */
.session-item-ago {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  flex-shrink: 0;
  opacity: 0.8;
}

.session-item-provider {
  font-size: 7px;
  line-height: 1;
  padding: 1px 4px;
  border-radius: 999px;
  font-weight: 600;
  letter-spacing: 0.02em;
  flex-shrink: 0;
  opacity: 0.65;
}

.session-item-provider.codex {
  background: var(--kt-color-component-session-provider-codex-bg);
  color: var(--kt-color-component-session-provider-codex-text);
}

.session-item-provider.claude {
  background: var(--kt-color-status-warning-soft);
  color: var(--kt-color-status-warning-strong);
}

.session-item.show-timeline .session-item-header {
  position: relative;
  top: auto;
  z-index: 2;
  background: transparent;
  box-shadow: none;
}

.session-item-header:hover {
  background: transparent;
}

.session-item:hover {
  background: var(--kt-color-alpha-white-04);
}

.session-item.active {
  background: transparent;
}

/* New Layout: Input / Timeline row with Source + Ago */
.session-item-toggle-left,
.session-item-toggle-right {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.session-item-toggle-right {
  margin-left: auto;
}

.session-item-toggle-source {
  font-size: 7px;
  padding: 1px 4px;
  border-radius: 4px;
  background: var(--kt-color-component-session-pane-chip-bg);
  color: var(--kt-color-text-primary);
  font-weight: 600;
  letter-spacing: 0.02em;
  background: transparent !important;
  color: var(--kt-color-text-secondary) !important;
  border: 1px solid var(--kt-color-alpha-white-08);
}

.session-item-toggle-source.claude {
  color: var(--kt-color-status-warning-strong) !important;
  border-color: var(--kt-color-status-warning-glow) !important;
}

.session-item-toggle-ago {
  font-size: 10px;
  color: var(--kt-color-text-primary);
  opacity: 0.88;
}

.session-item-input {
  font-size: 12px;
  font-weight: 500;
  color: var(--kt-color-text-primary);
  line-height: 1.4;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 0;
  margin-bottom: 0;
  flex: 1;
  min-width: 0;
}

.session-item-summary {
  margin: 4px 8px 4px 32px;
  font-size: 12px;
  font-weight: 600;
  line-height: 1.25;
  color: var(--kt-color-text-secondary);
  opacity: 0.95;
  white-space: normal;
  display: block;
  user-select: text;
}

.session-section-active .session-item-summary {
  color: var(--kt-color-text-secondary);
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
}

.session-item-summary.is-empty,
.session-section-history .session-item-summary {
  display: none;
}

.session-item-resume-btn {
  width: 16px;
  height: 16px;
  position: relative;
  margin-left: 0;
  border-radius: 4px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-muted);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  box-shadow: none;
  transition: none;
}

.session-item-resume-btn svg {
  width: 10px;
  height: 10px;
  display: block;
}

.session-item:hover .session-item-resume-btn,
.session-item-resume-btn:focus-visible {
  opacity: 1;
  pointer-events: auto;
  color: var(--kt-color-text-primary);
  border-color: transparent;
  background: transparent;
}

.session-item-resume-btn:hover {
  opacity: 1;
  color: var(--kt-color-text-primary);
  background: transparent;
  border-color: transparent;
  box-shadow: none;
}

.session-item-footer {
  display: none;
}

.session-item-toggle {
  width: 100%;
  min-height: 20px;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 8px;
  color: var(--kt-color-text-secondary);
  opacity: 0.8;
  transition: none;
  cursor: pointer;
  background: transparent;
  border: none;
  letter-spacing: normal;
}

.session-item:hover .session-item-toggle {
  opacity: 0.8;
}

.session-item-toggle:hover {
  opacity: 0.8;
  background: transparent;
  border-radius: 4px;
}

.session-item-toggle-target {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  height: auto;
  padding: 0;
  border-radius: 4px;
  border: none;
  background: transparent;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  font-size: 9px;
  line-height: 1;
  position: relative;
  transition: none;
}

.session-item-toggle-icon {
  width: 12px;
  height: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: none;
}

.session-item.show-timeline .session-item-toggle-icon {
  transform: rotate(180deg);
}

.session-item-toggle-target:hover {
  color: var(--kt-color-text-primary);
  background: transparent;
}

.session-item-toggle-target:active {
  background: var(--kt-color-alpha-white-12);
  transform: none;
}

.session-item-toggle-target:focus-visible {
  outline: 2px solid var(--kt-color-state-focus-ring);
  outline-offset: 1px;
}

.session-item.show-timeline .session-item-toggle-target {
  color: var(--kt-color-text-primary);
  background: transparent;
}

.session-item.show-timeline .session-item-footer {
  border-top-color: transparent;
  align-items: flex-end;
}

.session-item.show-timeline .session-item-footer::after {
  content: none;
}
/* Timeline */
.session-timeline {
  max-height: 0;
  overflow: hidden;
  transition: none;
  padding: 0;
  margin-left: 8px; /* Align with chevron */
  border-left: 1px solid var(--kt-color-component-session-pane-divider-strong);
  position: relative;
}

.session-item.show-timeline .session-timeline {
  max-height: none;
  margin-top: 0;
  padding-top: 4px;
  padding-bottom: 4px;
}


.session-timeline-entry {
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  margin: 0 0 0 6px;
  background: transparent;
  border: none;
  border-radius: 6px;
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  cursor: pointer;
  transition: none;
}

.session-timeline-entry::after {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  background: linear-gradient(110deg, transparent 0%, var(--kt-color-alpha-white-24) 42%, transparent 70%);
  background-size: 220% 100%;
  opacity: 0;
  pointer-events: none;
}

.session-timeline-entry.is-timeline-glint::after {
  animation: timeline-glint 0.55s ease-in-out 0s 2 alternate both;
}

/* Connector Dot */
.session-timeline-entry::before {
  content: '';
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  left: -8px;
  width: 4px;
  height: 4px;
  border-radius: 1px;
  background: var(--kt-color-component-session-pane-divider-strong);
  opacity: 0.8;
  transition: none;
}

.session-timeline-entry:hover::before {
  background: var(--kt-color-text-primary);
  opacity: 1;
}

.session-timeline-entry:hover {
  background: var(--kt-color-alpha-white-04);
}

.session-timeline-entry:nth-child(odd):not(:hover) {
  background: var(--kt-color-alpha-white-04);
}

@keyframes timeline-glint {
  0% { background-position: 120% 0; opacity: 0; }
  30% { opacity: 0.85; }
  70% { opacity: 0.75; }
  100% { background-position: -20% 0; opacity: 0; }
}

@keyframes session-glint {
  0% { transform: translate3d(-60%, 0, 0); opacity: 0; }
  12% { opacity: 0.8; }
  62% { opacity: 0.6; }
  100% { transform: translate3d(60%, 0, 0); opacity: 0; }
}

.session-timeline-input {
  font-size: 11px;
  color: var(--kt-color-text-primary);
  margin-bottom: 0;
  line-height: 1.5;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
}

.session-timeline-ago {
  font-size: 10px;
  color: var(--kt-color-text-secondary);
  opacity: 0.8;
  margin-left: auto;
  min-width: 42px;
  text-align: right;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.session-timeline-action {
  position: static;
  width: 20px;
  height: 20px;
  border-radius: 4px;
  border: 0;
  background: transparent;
  color: var(--kt-color-text-secondary);
  opacity: 0.45;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  line-height: 0;
  align-self: center;
  transition: none;
}

.session-timeline-action svg {
  width: 16px;
  height: 16px;
  display: block;
  transform: translateY(1px);
}

.session-timeline-entry:hover .session-timeline-action {
  opacity: 0.9;
  color: var(--kt-color-text-primary);
}

.session-timeline-output {
  display: none;
}

/* Restart Button (Hidden by default) */
.session-timeline-restart-btn {
  display: none;
}

.session-timeline-entry:hover .session-timeline-restart-btn {
  opacity: 1;
}

.session-timeline-restart-btn:hover {
  background: var(--kt-color-component-session-card-hover);
  border-color: var(--kt-color-component-session-pane-border);
  opacity: 1;
  box-shadow: 0 0 0 1px var(--kt-color-alpha-white-06);
}

.session-timeline-restart-btn svg {
  opacity: 1;
}

/* ========================================
   Left Pane Font Scale
   ======================================== */

#left-shell {
  --left-pane-card-radius: 2px;
}

#left-shell .session-sidebar-body,
#left-shell .pin-list {
  --session-group-header-height: calc(28px * var(--left-pane-font-scale));
}

.session-sidebar-resizer-icon {
  font-size: calc(12px * var(--left-pane-font-scale));
}

.session-sidebar-resizer-label {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .session-sidebar-title {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .session-sidebar-count {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .session-sidebar-search-input input {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .session-sidebar-search-status {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .session-section-empty {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .session-group-cwd {
  font-size: calc(14px * var(--left-pane-font-scale));
  background-size: calc(14px * var(--left-pane-font-scale)) calc(14px * var(--left-pane-font-scale));
  padding-left: calc(17px * var(--left-pane-font-scale));
}

#left-shell .session-group-badge {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .session-item-expander {
  width: calc(22px * var(--left-pane-font-scale));
  height: calc(22px * var(--left-pane-font-scale));
}

#left-shell .session-item-expander svg {
  width: calc(12px * var(--left-pane-font-scale));
  height: calc(12px * var(--left-pane-font-scale));
}

#left-shell .session-status-dot {
  width: calc(6px * var(--left-pane-font-scale));
  height: calc(6px * var(--left-pane-font-scale));
}

#left-shell .session-item-ago {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .session-item-input {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .session-item-resume-btn {
  width: calc(16px * var(--left-pane-font-scale));
  height: calc(16px * var(--left-pane-font-scale));
}

#left-shell .session-item-resume-btn svg {
  width: calc(10px * var(--left-pane-font-scale));
  height: calc(10px * var(--left-pane-font-scale));
}


#left-shell .session-timeline-entry {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .session-timeline-action {
  font-size: calc(9px * var(--left-pane-font-scale));
  width: calc(20px * var(--left-pane-font-scale));
  height: calc(20px * var(--left-pane-font-scale));
}

#left-shell .session-timeline-action svg {
  width: calc(16px * var(--left-pane-font-scale));
  height: calc(16px * var(--left-pane-font-scale));
  transform: translateY(calc(1px * var(--left-pane-font-scale)));
}

#left-shell .session-timeline-input {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .session-timeline-output {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .session-sidebar-loading,
#left-shell .session-sidebar-empty,
#left-shell .session-timeline-loading,
#left-shell .session-timeline-empty,
#left-shell .session-timeline-error {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .terminal-preview-toast {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .pins-filter-title {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .pin-project-title {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .pin-project-item {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .pin-project-count {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .pin-empty {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .search-item-meta {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .search-item-ago {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .search-item .session-item-input {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .search-item-output {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .search-item .session-item-toggle-label {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .search-item-detail .search-detail-empty,
#left-shell .search-item-detail .search-detail-loading {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .search-detail-label {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .search-detail-content {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .pin-item .session-item-input {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .pin-item .session-item-meta {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .pin-item .session-item-time {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .pin-item .session-item-output {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .pin-item .session-item-toggle-label {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .pin-item-detail .pin-detail-empty,
#left-shell .pin-item-detail .pin-detail-loading {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-empty {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-header {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-btn {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-label {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-content {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .pin-detail-truncated {
  font-size: calc(10px * var(--left-pane-font-scale));
}

#left-shell .terminal-pin-content {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .terminal-pin-loading {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .terminal-pin-truncated {
  font-size: calc(11px * var(--left-pane-font-scale));
}

#left-shell .terminal-pin-empty {
  font-size: calc(12px * var(--left-pane-font-scale));
}

#left-shell .terminal-session-badge {
  font-size: calc(9px * var(--left-pane-font-scale));
}

#left-shell .terminal-session-badge svg {
  width: calc(10px * var(--left-pane-font-scale));
  height: calc(10px * var(--left-pane-font-scale));
}
